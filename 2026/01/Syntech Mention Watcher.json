{
  "active": false,
  "activeVersion": null,
  "activeVersionId": null,
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Get All Sources",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking ‘Execute workflow’": {
      "main": [
        [
          {
            "node": "Get All Sources",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get All Sources": {
      "main": [
        [
          {
            "node": "Get Active Sources",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Match Sources": {
      "main": [
        [
          {
            "node": "Limit5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RSS Read": {
      "main": [
        [
          {
            "node": "Get 5 Ideas",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Active Sources": {
      "main": [
        [
          {
            "node": "If High Priority",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get All Results": {
      "main": [
        [
          {
            "node": "Remove Duplicates",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Remove Duplicates": {
      "main": [
        [
          {
            "node": "Filter1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If High Priority": {
      "main": [
        [
          {
            "node": "Merge3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Randomise",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Randomise": {
      "main": [
        [
          {
            "node": "Get 10 Ideas",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Match Input Format": {
      "main": [
        [
          {
            "node": "Classification agent with Batch1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Evaluation": {
      "main": [
        [
          {
            "node": "Set Output In Evaluation Google Sheet",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "select fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Run Evaluation": {
      "main": [
        [
          {
            "node": "Get All Sources1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If Publication Date": {
      "main": [
        [
          {
            "node": "Add New Content Idea6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Add New Content Idea1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get 10 Ideas": {
      "main": [
        [
          {
            "node": "Merge3",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Get 5 Ideas": {
      "main": [
        [
          {
            "node": "Scrape a url and get its content2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF text longer than 2000 chars": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If Publication Date",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Splits text in small chuncks": {
      "main": [
        [
          {
            "node": "IF2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF2": {
      "main": [
        [
          {
            "node": "If Publication Date2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Merge1": {
      "main": [
        [
          {
            "node": "Add Content To Post",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [
          {
            "node": "No Operation, do nothing",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Splits text in small chuncks",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Add New Content Idea4": {
      "main": [
        [
          {
            "node": "Set Article URL",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If Publication Date2": {
      "main": [
        [
          {
            "node": "Add New Content Idea4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Add New Content Idea5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Add New Content Idea5": {
      "main": [
        [
          {
            "node": "Set Article URL",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Article URL": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Add Content To Post": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge3": {
      "main": [
        [
          {
            "node": "Limit1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RSS search fields1": {
      "main": [
        [
          {
            "node": "Merge7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If From Form": {
      "main": [
        [
          {
            "node": "select fields",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Classification agent with Batch1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Limit5": {
      "main": [
        [
          {
            "node": "Loop Over Items4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If Not Error": {
      "main": [
        [
          {
            "node": "RSS search fields1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "failed urls",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "failed urls": {
      "main": [
        [
          {
            "node": "extract content",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge7": {
      "main": [
        [
          {
            "node": "Loop Over Items4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "format content": {
      "main": [
        [
          {
            "node": "Merge7",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "extract content": {
      "main": [
        [
          {
            "node": "extract date1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter1": {
      "main": [
        [
          {
            "node": "If From Form1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Markdown1": {
      "main": [
        [
          {
            "node": "Create summary and title",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "extract date1": {
      "main": [
        [
          {
            "node": "Markdown1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "select fields": {
      "main": [
        [
          {
            "node": "Get All Results",
            "type": "main",
            "index": 0
          },
          {
            "node": "Remove Duplicates",
            "type": "main",
            "index": 0
          },
          {
            "node": "filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items4": {
      "main": [
        [
          {
            "node": "is content empty?",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Either Url or Keyword4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Either Url or Keyword4": {
      "main": [
        [
          {
            "node": "RSS Read",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Scrape a url and get its content2": {
      "main": [
        [
          {
            "node": "If Not Error",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Remove Duplicates1": {
      "main": [
        [
          {
            "node": "Add Content Idea to Evaluation Table1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Google Sheet Fields": {
      "main": [
        [
          {
            "node": "Remove Duplicates1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get All Ideas From Evaluation Table2": {
      "main": [
        [
          {
            "node": "Remove Duplicates1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "is content empty?": {
      "main": [
        [
          {
            "node": "Remove Duplicates3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If From Form1": {
      "main": [
        [
          {
            "node": "IF text longer than 2000 chars",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Valid content only (score above 2)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Remove Duplicates3": {
      "main": [
        [
          {
            "node": "If From Form",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Sort": {
      "main": [
        [
          {
            "node": "Get 10 best articles",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get 10 best articles": {
      "main": [
        [
          {
            "node": "Evaluation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Valid content only (score above 2)": {
      "main": [
        [
          {
            "node": "IF text longer than 2000 chars",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Limit1": {
      "main": [
        [
          {
            "node": "Match Sources",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get All Sources1": {
      "main": [
        [
          {
            "node": "Match Input Format",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Classification agent with Batch1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Classification agent with Batch1": {
      "main": [
        [
          {
            "node": "Sort",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Classification agent with Batch1",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "filter": {
      "main": [
        [
          {
            "node": "Set Google Sheet Fields",
            "type": "main",
            "index": 0
          },
          {
            "node": "Get All Ideas From Evaluation Table2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Create summary and title",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser2": {
      "ai_outputParser": [
        [
          {
            "node": "Create summary and title",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Create summary and title": {
      "main": [
        [
          {
            "node": "format content",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Evaluation1": {
      "main": [
        []
      ]
    },
    "OpenAI Chat Model8": {
      "ai_languageModel": [
        [
          {
            "node": "Evaluation1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Set Output In Evaluation Google Sheet": {
      "main": [
        [
          {
            "node": "Evaluation1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2026-01-28T09:06:07.192Z",
  "id": "RjoxltBC5OFVdmmg",
  "isArchived": false,
  "meta": null,
  "name": "Syntech Mention Watcher",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 5
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -2800,
        984
      ],
      "id": "6ccddea5-d6c8-4e6b-a9f4-204513252820",
      "name": "Schedule Trigger",
      "disabled": true
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -2800,
        1176
      ],
      "id": "61639dc3-3640-436f-89ef-34b0ba7a018c",
      "name": "When clicking ‘Execute workflow’"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": {
          "__rl": true,
          "value": "27a785c0-cfab-807b-b5eb-e1214e18960d",
          "mode": "list",
          "cachedResultName": "Syntech Biofuels Static Sources",
          "cachedResultUrl": "https://www.notion.so/27a785c0cfab807bb5ebe1214e18960d"
        },
        "returnAll": true,
        "options": {}
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        -2576,
        1080
      ],
      "id": "b2745d54-cdb5-4960-b830-a7f01469a7f9",
      "name": "Get All Sources",
      "credentials": {
        "notionApi": {
          "id": "v7nNI35XIwsY1JzB",
          "name": "Syntech.granite"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.source || $if($('Get All Sources').isExecuted, $('Get All Sources').item.json.property_source, null) }}",
                    "rightValue": "RSS",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "64eaa223-9be7-410e-8ff2-3e07451e36fe"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "RSS"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.3,
      "position": [
        -1008,
        1080
      ],
      "id": "d3838c04-995d-4d07-8424-575ee3cf2e49",
      "name": "Match Sources"
    },
    {
      "parameters": {
        "url": "={{ $json.url_or_keyword }}",
        "options": {}
      },
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1.2,
      "position": [
        -112,
        440
      ],
      "id": "065c508e-7c34-415f-b847-16d6e778a1a4",
      "name": "RSS Read",
      "alwaysOutputData": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "45d48713-c0cb-44ab-83fc-168ac9a7c419",
              "leftValue": "={{ $json.property_status }}",
              "rightValue": "Active",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2.2,
      "position": [
        -2352,
        1080
      ],
      "id": "f665c718-f9a0-4264-b3de-d71c7238a141",
      "name": "Get Active Sources"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": {
          "__rl": true,
          "value": "27c785c0-cfab-8137-800f-dcf3e01a3e97",
          "mode": "list",
          "cachedResultName": "Syntech Biofuel Content Ideas",
          "cachedResultUrl": "https://www.notion.so/27c785c0cfab8137800fdcf3e01a3e97"
        },
        "returnAll": true,
        "options": {}
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        1648,
        1684
      ],
      "id": "32c71816-b04b-4c5a-949b-a60fc6ab354c",
      "name": "Get All Results",
      "executeOnce": true,
      "alwaysOutputData": true,
      "credentials": {
        "notionApi": {
          "id": "v7nNI35XIwsY1JzB",
          "name": "Syntech.granite"
        }
      }
    },
    {
      "parameters": {
        "mode": "combine",
        "advanced": true,
        "mergeByFields": {
          "values": [
            {
              "field1": "url",
              "field2": "property_source_url"
            }
          ]
        },
        "joinMode": "keepNonMatches",
        "outputDataFrom": "input1",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        2000,
        1612
      ],
      "id": "2aeda134-b43c-4c6c-b906-9a4c0704c6e5",
      "name": "Remove Duplicates"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "b5d7e3e1-0a6d-47e3-8762-1d6bcb90d942",
              "leftValue": "={{ $json.property_priority }}",
              "rightValue": "High",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -2128,
        1080
      ],
      "id": "0633b219-ca97-40d3-a11b-3dfe89590065",
      "name": "If High Priority"
    },
    {
      "parameters": {
        "type": "random"
      },
      "type": "n8n-nodes-base.sort",
      "typeVersion": 1,
      "position": [
        -1904,
        1152
      ],
      "id": "44649ece-6b5c-4564-9d56-35e96cb867bf",
      "name": "Randomise"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a4678c4d-3605-43b3-930d-54f3db0cf209",
              "name": "content",
              "value": "={{ $('Run Evaluation').item.json.Content }}",
              "type": "string"
            },
            {
              "id": "960e3dc3-5af8-4535-bca0-6db869b1bed0",
              "name": "url",
              "value": "={{ $('Run Evaluation').item.json.URL }}",
              "type": "string"
            },
            {
              "id": "084b87c7-e199-4284-89d5-a2a5bb7a69e7",
              "name": "title",
              "value": "={{ $('Run Evaluation').item.json.Title }}",
              "type": "string"
            },
            {
              "id": "4957e170-7f99-4439-8b8a-29e930aa8823",
              "name": "publication_date",
              "value": "={{ $('Run Evaluation').item.json[\"Publication Date\"] }}",
              "type": "string"
            },
            {
              "id": "7bf20e2e-95b3-4acc-9a9b-7fcf895f1ad2",
              "name": "expected_relevance",
              "value": "={{ $('Run Evaluation').item.json[\"Expected Score\"] }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        112,
        1972
      ],
      "id": "fff104ec-3230-4425-8839-450dab1c42a6",
      "name": "Match Input Format",
      "executeOnce": true
    },
    {
      "parameters": {
        "operation": "checkIfEvaluating"
      },
      "type": "n8n-nodes-base.evaluation",
      "typeVersion": 4.7,
      "position": [
        1136,
        944
      ],
      "id": "acee25b4-6bcc-4148-8248-e844ea377682",
      "name": "Evaluation"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1DGxbB-WIk_Ycv8W0iH7dXUo6ESu67ZqLNFhXB8w3-AI",
          "mode": "list",
          "cachedResultName": "Syntech Evaluation Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1DGxbB-WIk_Ycv8W0iH7dXUo6ESu67ZqLNFhXB8w3-AI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Evaluations",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1DGxbB-WIk_Ycv8W0iH7dXUo6ESu67ZqLNFhXB8w3-AI/edit#gid=0"
        }
      },
      "type": "n8n-nodes-base.evaluationTrigger",
      "typeVersion": 4.6,
      "position": [
        -336,
        1972
      ],
      "id": "26613fbf-0ec3-484a-bd19-961b33269369",
      "name": "Run Evaluation",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "TvN6HmHHfgKukni4",
          "name": "Stephen Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1DGxbB-WIk_Ycv8W0iH7dXUo6ESu67ZqLNFhXB8w3-AI",
          "mode": "list",
          "cachedResultName": "Syntech Evaluation Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1DGxbB-WIk_Ycv8W0iH7dXUo6ESu67ZqLNFhXB8w3-AI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Evaluations",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1DGxbB-WIk_Ycv8W0iH7dXUo6ESu67ZqLNFhXB8w3-AI/edit#gid=0"
        },
        "outputs": {
          "values": [
            {
              "outputName": "Actual_Score",
              "outputValue": "={{ $json.output.relevance_score }}"
            },
            {
              "outputName": "AI_Reasoning",
              "outputValue": "={{ $('Classification agent with Batch1').item.json.output.reason }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.evaluation",
      "typeVersion": 4.7,
      "position": [
        1360,
        944
      ],
      "id": "4065420f-4e2e-4fc3-bc33-f3438b95b6a3",
      "name": "Set Output In Evaluation Google Sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "TvN6HmHHfgKukni4",
          "name": "Stephen Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "e20ca9df-9034-44ac-8d9e-ecad56c6a923",
              "leftValue": "={{ $('Merge').item.json.publication_date }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        3184,
        1924
      ],
      "id": "5d076561-66bc-4889-bb94-b1bf28929a3e",
      "name": "If Publication Date"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "databaseId": {
          "__rl": true,
          "value": "27c785c0-cfab-8137-800f-dcf3e01a3e97",
          "mode": "list",
          "cachedResultName": "Syntech Biofuel Content Ideas",
          "cachedResultUrl": "https://www.notion.so/27c785c0cfab8137800fdcf3e01a3e97"
        },
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Article Name|title",
              "title": "={{ $('Remove Duplicates').item.json.title }}"
            },
            {
              "key": "Source URL|url",
              "urlValue": "={{ $('Remove Duplicates').item.json.url }}"
            },
            {
              "key": "Status|select",
              "selectValue": "Not Reviewed"
            },
            {
              "key": "Search Query|rich_text",
              "textContent": "={{ $('Merge').item.json.url }}"
            },
            {
              "key": "Summary|rich_text",
              "textContent": "={{ $('Merge').item.json.summary }}"
            },
            {
              "key": "Source|multi_select",
              "multiSelectValue": "={{ $json.source }}"
            },
            {
              "key": "Own Analysis|rich_text",
              "textContent": "={{ $if($('Merge').isExecuted, $('Merge').item.json.prompt || '', '') }}"
            }
          ]
        },
        "blockUi": {
          "blockValues": [
            {
              "textContent": "={{ $('Merge').item.json.content || '' }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        3408,
        2020
      ],
      "id": "dae1f1e9-3775-4501-9faf-d02211763390",
      "name": "Add New Content Idea1",
      "alwaysOutputData": false,
      "credentials": {
        "notionApi": {
          "id": "v7nNI35XIwsY1JzB",
          "name": "Syntech.granite"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "maxItems": 10
      },
      "type": "n8n-nodes-base.limit",
      "typeVersion": 1,
      "position": [
        -1680,
        1152
      ],
      "id": "6f3b78cf-ad06-4008-a631-054a700495c6",
      "name": "Get 10 Ideas"
    },
    {
      "parameters": {
        "maxItems": 10
      },
      "type": "n8n-nodes-base.limit",
      "typeVersion": 1,
      "position": [
        112,
        440
      ],
      "id": "e1de6869-4309-47a7-b69b-65f64849d1a8",
      "name": "Get 5 Ideas"
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{  $('Remove Duplicates').item.json.content?.length() }}",
              "operation": "larger",
              "value2": 2000
            }
          ]
        }
      },
      "id": "66e7b173-1a49-4a13-8bb1-66f00384bc96",
      "name": "IF text longer than 2000 chars",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        2960,
        1624
      ]
    },
    {
      "parameters": {
        "jsCode": "let result = [];\nlet firstBlock = true;\n\n// Split text on \\n characters - FIXED: Use .item instead of .first() to get current item\nlet textBlocks = $('Remove Duplicates').item.json.content.split(/\\n/);\n\nfor (let block of textBlocks) {\n    if (block.length === 0) continue;\n    result.push({\n        \"textSubString\": block.trim(),\n        \"firstBlock\": firstBlock\n    });\n    firstBlock = false;\n}\n\nreturn result;"
      },
      "id": "f6da9966-0f02-4944-bea1-8065ac9e5555",
      "name": "Splits text in small chuncks",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3408,
        1108
      ]
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{ $json.firstBlock }}",
              "value2": true
            }
          ]
        }
      },
      "id": "3957f7bd-abf6-433f-8823-499dd479e575",
      "name": "IF2",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        3632,
        1108
      ]
    },
    {
      "parameters": {
        "mode": "combine",
        "combinationMode": "multiplex",
        "options": {}
      },
      "id": "0cbfd5c6-47db-451a-80db-6dfecb150d37",
      "name": "Merge1",
      "type": "n8n-nodes-base.merge",
      "typeVersion": 2.1,
      "position": [
        4528,
        1108
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        3184,
        1492
      ],
      "id": "dbf7ac7c-fb0b-4cb0-9d1a-011351cadb15",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "databaseId": {
          "__rl": true,
          "value": "27c785c0-cfab-8137-800f-dcf3e01a3e97",
          "mode": "list",
          "cachedResultName": "Syntech Biofuel Content Ideas",
          "cachedResultUrl": "https://www.notion.so/27c785c0cfab8137800fdcf3e01a3e97"
        },
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Article Name|title",
              "title": "={{ $('Remove Duplicates').item.json.title }}"
            },
            {
              "key": "Source URL|url",
              "urlValue": "={{ $('Remove Duplicates').item.json.url }}"
            },
            {
              "key": "Source|multi_select",
              "multiSelectValue": "={{ $('Merge').item.json.source }}"
            },
            {
              "key": "Status|select",
              "selectValue": "Not Reviewed"
            },
            {
              "key": "Search Query|rich_text",
              "textContent": "={{ $('Merge').item.json.search_query }}"
            },
            {
              "key": "Publication Date|date",
              "date": "={{ $('Merge').item.json.publication_date }}"
            },
            {
              "key": "Summary|rich_text",
              "textContent": "={{ $('Merge').item.json.summary }}"
            },
            {
              "key": "Own Analysis|rich_text",
              "textContent": "={{ $if($('Merge').isExecuted, $('Merge').item.json.prompt || '', '') }}"
            }
          ]
        },
        "blockUi": {
          "blockValues": [
            {
              "textContent": "={{ $json.textSubString }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        4080,
        940
      ],
      "id": "ee323fc6-5d06-4d67-94d4-2e5181c7663a",
      "name": "Add New Content Idea4",
      "alwaysOutputData": false,
      "credentials": {
        "notionApi": {
          "id": "v7nNI35XIwsY1JzB",
          "name": "Syntech.granite"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "e20ca9df-9034-44ac-8d9e-ecad56c6a923",
              "leftValue": "={{ $('Merge').item.json.publication_date }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        3856,
        1036
      ],
      "id": "99c59e67-2d4a-4d50-81af-bff4388c2f3e",
      "name": "If Publication Date2"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "databaseId": {
          "__rl": true,
          "value": "27c785c0-cfab-8137-800f-dcf3e01a3e97",
          "mode": "list",
          "cachedResultName": "Syntech Biofuels Content Ideas",
          "cachedResultUrl": "https://www.notion.so/27c785c0cfab8137800fdcf3e01a3e97"
        },
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Article Name|title",
              "title": "={{ $('Remove Duplicates').item.json.title }}"
            },
            {
              "key": "Source URL|url",
              "urlValue": "={{ $('Remove Duplicates').item.json.url }}"
            },
            {
              "key": "Source|multi_select",
              "multiSelectValue": "={{ $('Merge').item.json.source }}"
            },
            {
              "key": "Status|select",
              "selectValue": "Not Reviewed"
            },
            {
              "key": "Search Query|rich_text",
              "textContent": "={{ $('Merge').item.json.url }}"
            },
            {
              "key": "Summary|rich_text",
              "textContent": "={{ $('Merge').item.json.summary }}"
            },
            {
              "key": "Own Analysis|rich_text",
              "textContent": "={{ $if($('Merge').isExecuted, $('Merge').item.json.prompt || '', '') }}"
            }
          ]
        },
        "blockUi": {
          "blockValues": [
            {
              "textContent": "={{ $json.textSubString }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        4080,
        1132
      ],
      "id": "311994cc-ad58-470e-b878-25ae811d63ef",
      "name": "Add New Content Idea5",
      "alwaysOutputData": false,
      "credentials": {
        "notionApi": {
          "id": "v7nNI35XIwsY1JzB",
          "name": "Syntech.granite"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "fields": {
          "values": [
            {
              "name": "url",
              "stringValue": "={{ $json.url }}"
            }
          ]
        },
        "include": "none",
        "options": {}
      },
      "id": "c239629c-f1fd-47c1-b875-e0f48d7340ba",
      "name": "Set Article URL",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.2,
      "position": [
        4304,
        1036
      ]
    },
    {
      "parameters": {
        "resource": "block",
        "blockId": {
          "__rl": true,
          "value": "={{ $json.url }}",
          "mode": "url"
        },
        "blockUi": {
          "blockValues": [
            {
              "textContent": "={{ $json.textSubString }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        4752,
        1276
      ],
      "id": "c0396d71-619c-413f-9aee-8b7953996501",
      "name": "Add Content To Post",
      "credentials": {
        "notionApi": {
          "id": "v7nNI35XIwsY1JzB",
          "name": "Syntech.granite"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "scrape",
        "url": "={{ $json.link }}",
        "scrapeOptions": {
          "options": {
            "formats": {
              "format": [
                {},
                {
                  "type": "summary"
                }
              ]
            },
            "excludeTags": {
              "items": [
                {
                  "tag": "footer"
                },
                {
                  "tag": "script"
                },
                {
                  "tag": "nav"
                },
                {
                  "tag": "style"
                }
              ]
            },
            "headers": {}
          }
        },
        "requestOptions": {}
      },
      "type": "@mendable/n8n-nodes-firecrawl.firecrawl",
      "typeVersion": 1,
      "position": [
        400,
        440
      ],
      "id": "62190e5e-707b-4627-bca5-75a83955d482",
      "name": "Scrape a url and get its content2",
      "credentials": {
        "firecrawlApi": {
          "id": "BNVJqHXn81DoWSYA",
          "name": "Firecrawl account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        3408,
        1348
      ],
      "id": "bb10b51f-e8ba-4edf-94f3-faeee7e0b427",
      "name": "No Operation, do nothing"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -1456,
        1080
      ],
      "id": "b93c10ed-64cb-4840-b55a-4f755fc56db6",
      "name": "Merge3"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "8efead37-57d8-4101-9010-c855f2525db6",
              "name": "url_or_keyword",
              "value": "={{ $json.property_rss_feed || $json.url_or_keyword }}",
              "type": "string"
            },
            {
              "id": "7ca00974-25ef-4c7a-ac32-42d318e2efaa",
              "name": "prompt",
              "value": "={{ $json.prompt }}",
              "type": "string"
            },
            {
              "id": "2a3d10ea-9972-4e63-a289-f79cfec66ac6",
              "name": "additional_formats",
              "value": "={{ $json.additional_formats }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -336,
        440
      ],
      "id": "e0881930-901b-42b7-a7d8-341b3d0ce83a",
      "name": "Either Url or Keyword4"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "1d34aa6b-dce8-4761-9a9a-a663f61a86ac",
              "name": "title",
              "value": "={{ $('RSS Read').item.json.title }}",
              "type": "string"
            },
            {
              "id": "ab5c9158-a33a-4f8f-b6d0-a6787df0f0d5",
              "name": "content",
              "value": "={{ \n  $json.data.markdown    \n    // Remove Markdown headers (e.g., #, ##, ###)\n    .replace(/(^|\\n)#+\\s?/g, '\\n')\n    // Remove bold and italics (**text**, *text*, __text__, _text_)\n    .replace(/(\\*\\*|__)(.*?)\\1/g, '$2')\n    .replace(/(\\*|_)(.*?)\\1/g, '$2')\n    // Remove inline code and code blocks\n    .replace(/`{1,3}[^`]*`{1,3}/g, '')\n    // Remove images ![alt](url)\n    .replace(/!\\[.*?\\]\\(.*?\\)/g, '')\n    // Replace links [text](url) with just text\n    .replace(/\\[(.*?)\\]\\(.*?\\)/g, '$1')\n    // Remove blockquotes\n    .replace(/(^|\\n)>\\s?/g, '\\n')\n    // Remove unordered and ordered list markers\n    .replace(/(^|\\n)[\\*\\-\\+]\\s+/g, '\\n')\n    .replace(/(^|\\n)\\d+\\.\\s+/g, '\\n')\n    // Replace multiple newlines with a single newline\n    .replace(/\\n{2,}/g, '\\n\\n')\n    // Trim whitespace\n    .trim()\n}}",
              "type": "string"
            },
            {
              "id": "f0c15fc7-071d-406d-8200-abecbf458836",
              "name": "url",
              "value": "={{ $('RSS Read').item.json.link }}",
              "type": "string"
            },
            {
              "id": "81fb049e-bbc7-49f8-b932-9f2d3ae0305d",
              "name": "summary",
              "value": "={{ $('RSS Read').item.json['content:encodedSnippet'] || $('RSS Read').item.json.summary || $('RSS Read').item.json.contentSnippet }}",
              "type": "string"
            },
            {
              "id": "39872c24-4acc-4513-b7fb-7689cd511afb",
              "name": "search_query",
              "value": "={{ $('Limit5').item.json.property_rss_feed || $('sources').item.json.url_or_keyword }}",
              "type": "string"
            },
            {
              "id": "42852696-c7af-4ce4-a273-e61970ef2e8f",
              "name": "publication_date",
              "value": "={{ $('RSS Read').item.json.pubDate || $('Scrape a url and get its content2').item.json.data.metadata.publishedTime || $('Scrape a url and get its content2').item.json.data.metadata.publishedTime || $('Scrape a url and get its content2').item.json.data.metadata['article:published_time'] }}",
              "type": "string"
            },
            {
              "id": "6bd73285-c360-4b10-8567-8ae66ecba2bd",
              "name": "prompt",
              "value": "={{ $if($('sources').isExecuted, $('sources').item.json.prompt, \"\") }}",
              "type": "string"
            },
            {
              "id": "101c6d7f-6e56-4362-9238-0b3e4fd7f14d",
              "name": "additional_formats",
              "value": "={{ $if($('sources').isExecuted, $('sources').item.json.additional_formats, \"\") }}",
              "type": "string"
            },
            {
              "id": "a0b9d46b-67d2-4152-b1fa-2306fa5751e4",
              "name": "source",
              "value": "RSS",
              "type": "string"
            },
            {
              "id": "9aea88f6-a629-4f42-ba37-8608bb631772",
              "name": "mode",
              "value": "={{ $if($('sources').isExecuted, $('sources').item.json.process_mode, \"\") }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2288,
        400
      ],
      "id": "05c9cead-5aac-41e7-9baf-58b464991e11",
      "name": "RSS search fields1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "cc515966-f679-4152-a85b-f524bb588f34",
              "leftValue": "={{ $if($('sources').isExecuted, $('sources').item.json.bypass_filter, false) }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        112,
        1080
      ],
      "id": "1083aaf9-b7e5-4ecc-bf16-15d284331b2b",
      "name": "If From Form"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.limit",
      "typeVersion": 1,
      "position": [
        -784,
        1080
      ],
      "id": "431edadb-a08e-4e3e-ba5b-d83e33575482",
      "name": "Limit5"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "6e532ff2-3eee-4984-88ef-3cc30f2e6bdf",
              "leftValue": "={{ $json.error }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notExists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        688,
        440
      ],
      "id": "22dcc4d9-2d1e-4818-aef4-0a7b1dc2dd6a",
      "name": "If Not Error"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0f1fd4a3-670d-4861-af5b-bc94fa454574",
              "name": "failed_url",
              "value": "={{ $('RSS Read').item.json.link }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        912,
        648
      ],
      "id": "a24ec391-71d0-436e-adf2-0eaa44f038f4",
      "name": "failed urls",
      "executeOnce": false
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        2512,
        684
      ],
      "id": "60c49495-9099-4fdb-beb1-4b86897ea841",
      "name": "Merge7"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "1d34aa6b-dce8-4761-9a9a-a663f61a86ac",
              "name": "title",
              "value": "={{ $json.output.title }}",
              "type": "string"
            },
            {
              "id": "ab5c9158-a33a-4f8f-b6d0-a6787df0f0d5",
              "name": "=content",
              "value": "={{ \n  $('Markdown1').item.json.linebreak    \n    // Remove everything before the main article title (remove navigation/header)\n    .replace(/^[\\s\\S]*?(?=\\n[A-Z][^\\n]{20,}\\n)/m, '')\n    // Remove author bios (e.g., \"Name Name is a freelance writer...\")\n    .replace(/\\n[A-Z][a-z]+\\s+[A-Z][a-z]+\\s+is\\s+(a|an)\\s+[\\s\\S]*?(?=\\n[A-Z]|$)/gi, '')\n    // Remove comment sections\n    .replace(/\\n(Leave a Reply|Leave a Comment)[\\s\\S]*$/i, '')\n    .replace(/\\nYour email address[\\s\\S]*$/i, '')\n    .replace(/\\nComment\\s*\\\\?\\*[\\s\\S]*$/i, '')\n    // Remove \"This site uses Akismet\" and everything after\n    .replace(/\\nThis site uses[\\s\\S]*$/i, '')\n    // Remove social/footer sections\n    .replace(/\\n(Follow Us|Check Out Our|About Us|Fuel News Center|Search Site|Energy News|Grab Our Free|Proudly powered by)[\\s\\S]*$/i, '')\n    // Remove footers (common patterns)\n    .replace(/\\n(Share this:|Related Posts?:|Tags?:|Categories:|Filed Under:|About the Author|Subscribe|Newsletter|Follow us)[\\s\\S]*$/i, '')\n    // Remove navigation lists (lines starting with * followed by capitalized words)\n    .replace(/(^|\\n)\\s*\\*\\s+[A-Z][^\\n]*(\\n\\s*\\*\\s+[A-Z][^\\n]*)*/g, '')\n    // Remove \"Search for:\" and similar patterns\n    .replace(/\\n(Search for:|Submit Press Release|Free ebook|Green Job Board).*$/gm, '')\n    // Remove date/author lines (e.g., \"October 21, 2025 By Author Name\")\n    .replace(/\\n[A-Z][a-z]+\\s+\\d{1,2},\\s+\\d{4}\\s+By\\s+[^\\n]+\\n/g, '\\n')\n    // Remove Markdown headers (e.g., #, ##, ###)\n    .replace(/(^|\\n)#+\\s?/g, '\\n')\n    // Remove bold and italics (**text**, *text*, __text__, _text_)\n    .replace(/(\\*\\*|__)(.*?)\\1/g, '$2')\n    .replace(/(\\*|_)(.*?)\\1/g, '$2')\n    // Remove inline code and code blocks\n    .replace(/`{1,3}[^`]*`{1,3}/g, '')\n    // Remove images ![alt](url)\n    .replace(/!\\[.*?\\]\\(.*?\\)/g, '')\n    // Replace links [text](url) with just text\n    .replace(/\\[(.*?)\\]\\(.*?\\)/g, '$1')\n    // Remove blockquotes\n    .replace(/(^|\\n)>\\s?/g, '\\n')\n    // Remove unordered and ordered list markers (but keep the text)\n    .replace(/(^|\\n)[\\*\\-\\+]\\s+/g, '\\n')\n    .replace(/(^|\\n)\\d+\\.\\s+/g, '\\n')\n    // Remove lines that are just navigation/menu items (short capitalized lines)\n    .replace(/\\n[A-Z][a-z\\s]{2,30}\\n(?=[A-Z])/g, '\\n')\n    // Remove escaped characters\n    .replace(/\\\\([*_\\[\\](){}])/g, '$1')\n    // Remove special symbols like Δ\n    .replace(/Δ/g, '')\n    // Remove short trailing lines (likely footer fragments)\n    .replace(/\\n[^\\n]{1,40}$/g, '')\n    // Replace multiple newlines with double newline for paragraphs\n    .replace(/\\n{3,}/g, '\\n\\n')\n    // Trim whitespace\n    .trim()\n}}\n",
              "type": "string"
            },
            {
              "id": "f0c15fc7-071d-406d-8200-abecbf458836",
              "name": "url",
              "value": "={{ $('RSS Read').item.json.link }}",
              "type": "string"
            },
            {
              "id": "81fb049e-bbc7-49f8-b932-9f2d3ae0305d",
              "name": "summary",
              "value": "={{ $json.output.summary }}",
              "type": "string"
            },
            {
              "id": "39872c24-4acc-4513-b7fb-7689cd511afb",
              "name": "search_query",
              "value": "={{ $('Either Url or Keyword4').item.json.url_or_keyword }}",
              "type": "string"
            },
            {
              "id": "42852696-c7af-4ce4-a273-e61970ef2e8f",
              "name": "publication_date",
              "value": "={{ $('extract date1').item.json.publishedDate }}",
              "type": "string"
            },
            {
              "id": "6bd73285-c360-4b10-8567-8ae66ecba2bd",
              "name": "=prompt",
              "value": "={{ $if($('sources').isExecuted, $('sources').item.json.prompt, \"\") }}",
              "type": "string"
            },
            {
              "id": "101c6d7f-6e56-4362-9238-0b3e4fd7f14d",
              "name": "=additional_formats",
              "value": "={{ $if($('sources').isExecuted, $('sources').item.json.additional_formats, \"\") }}",
              "type": "string"
            },
            {
              "id": "a0b9d46b-67d2-4152-b1fa-2306fa5751e4",
              "name": "source",
              "value": "RSS",
              "type": "string"
            },
            {
              "id": "9aea88f6-a629-4f42-ba37-8608bb631772",
              "name": "mode",
              "value": "={{ $if($('sources').isExecuted, $('sources').item.json.process_mode, \"\") }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2288,
        648
      ],
      "id": "54d42ee1-406b-43db-95dc-5aae138f568a",
      "name": "format content"
    },
    {
      "parameters": {
        "url": "={{ $json.failed_url }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
            },
            {
              "name": "Accept",
              "value": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"
            },
            {
              "name": "Accept-Language",
              "value": "en-US,en;q=0.9"
            },
            {
              "name": "Cache-Control",
              "value": "no-cache"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1136,
        648
      ],
      "id": "21acd041-3d54-4175-a293-bc893495172c",
      "name": "extract content",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "247ed307-8463-4caa-9de5-e9455e7fff0e",
              "leftValue": "={{ $json.title }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            },
            {
              "id": "f09df063-615e-422c-adf7-644526f1ad7d",
              "leftValue": "={{ $json.summary }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            },
            {
              "id": "82027463-f683-403b-bec7-1d15ca9b53b7",
              "leftValue": "={{ $json.content }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2.2,
      "position": [
        2288,
        1612
      ],
      "id": "0b463be7-2931-426c-bc3a-9398109ba62a",
      "name": "Filter1"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "databaseId": {
          "__rl": true,
          "value": "27c785c0-cfab-8137-800f-dcf3e01a3e97",
          "mode": "list",
          "cachedResultName": "Syntech Biofuel Content Ideas",
          "cachedResultUrl": "https://www.notion.so/27c785c0cfab8137800fdcf3e01a3e97"
        },
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Article Name|title",
              "title": "={{ $('Remove Duplicates').item.json.title }}"
            },
            {
              "key": "Source URL|url",
              "urlValue": "={{ $('Remove Duplicates').item.json.url }}"
            },
            {
              "key": "Source|multi_select",
              "multiSelectValue": "={{ $('Merge').item.json.source }}"
            },
            {
              "key": "Status|select",
              "selectValue": "Not Reviewed"
            },
            {
              "key": "Search Query|rich_text",
              "textContent": "={{ $('Merge').item.json.search_query }}"
            },
            {
              "key": "Summary|rich_text",
              "textContent": "={{ $('Merge').item.json.summary }}"
            },
            {
              "key": "Own Analysis|rich_text",
              "textContent": "={{ $if($('Merge').isExecuted, $('Merge').item.json.prompt || '', '') }}"
            },
            {
              "key": "Publication Date|date",
              "date": "={{ $('Merge').item.json.publication_date.toDateTime() }}"
            }
          ]
        },
        "blockUi": {
          "blockValues": [
            {
              "textContent": "={{ $('Remove Duplicates').item.json.content }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        3408,
        1828
      ],
      "id": "fd2ba940-911a-475b-8c61-0c8591ac71f9",
      "name": "Add New Content Idea6",
      "alwaysOutputData": false,
      "credentials": {
        "notionApi": {
          "id": "v7nNI35XIwsY1JzB",
          "name": "Syntech.granite"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "html": "={{ $('extract content').item.json.data }}",
        "destinationKey": "linebreak",
        "options": {}
      },
      "type": "n8n-nodes-base.markdown",
      "typeVersion": 1,
      "position": [
        1648,
        648
      ],
      "id": "0f0c51e7-52d4-4b84-8491-5213653668e6",
      "name": "Markdown1"
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "const htmlContent = $node[\"extract content\"].json[\"data\"];\n\n// Function to extract published date from various HTML patterns\nconst extractPublishedDate = (html) => {\n    if (!html) return null;\n    \n    // 1. Open Graph meta tags (most common)\n    let match = html.match(/<meta[^>]*property=[\"']article:published_time[\"'][^>]*content=[\"']([^\"']+)[\"'][^>]*>/i);\n    if (match?.[1]) return match[1];\n    \n    match = html.match(/<meta[^>]*content=[\"']([^\"']+)[\"'][^>]*property=[\"']article:published_time[\"'][^>]*>/i);\n    if (match?.[1]) return match[1];\n    \n    // 2. Schema.org meta tags\n    match = html.match(/<meta[^>]*itemprop=[\"']datePublished[\"'][^>]*content=[\"']([^\"']+)[\"'][^>]*>/i);\n    if (match?.[1]) return match[1];\n    \n    match = html.match(/<meta[^>]*content=[\"']([^\"']+)[\"'][^>]*itemprop=[\"']datePublished[\"'][^>]*>/i);\n    if (match?.[1]) return match[1];\n    \n    // 3. Standard meta name tags\n    const metaNames = [\n        'publishdate', 'publication-date', 'date', 'pubdate', 'publish_date',\n        'published-date', 'article.published', 'article:published',\n        'datePublished', 'dc.date', 'DC.date', 'dc.date.issued',\n        'sailthru.date', 'article.created', 'last-modified', 'created'\n    ];\n    \n    for (const name of metaNames) {\n        match = html.match(new RegExp(`<meta[^>]*name=[\"']${name}[\"'][^>]*content=[\"']([^\"']+)[\"'][^>]*>`, 'i'));\n        if (match?.[1]) return match[1];\n        \n        match = html.match(new RegExp(`<meta[^>]*content=[\"']([^\"']+)[\"'][^>]*name=[\"']${name}[\"'][^>]*>`, 'i'));\n        if (match?.[1]) return match[1];\n    }\n    \n    // 4. JSON-LD structured data\n    const jsonLdMatch = html.match(/<script[^>]*type=[\"']application\\/ld\\+json[\"'][^>]*>([\\s\\S]*?)<\\/script>/gi);\n    if (jsonLdMatch) {\n        for (const jsonBlock of jsonLdMatch) {\n            try {\n                const jsonContent = jsonBlock.replace(/<script[^>]*>|<\\/script>/gi, '').trim();\n                const data = JSON.parse(jsonContent);\n                \n                // Handle both single objects and arrays\n                const items = Array.isArray(data) ? data : [data];\n                \n                for (const item of items) {\n                    if (item.datePublished) return item.datePublished;\n                    if (item.publishedDate) return item.publishedDate;\n                    if (item.dateCreated) return item.dateCreated;\n                    if (item.article?.datePublished) return item.article.datePublished;\n                }\n            } catch (e) {\n                // Continue if JSON parsing fails\n            }\n        }\n    }\n    \n    // 5. Time tags with datetime attribute\n    match = html.match(/<time[^>]*datetime=[\"']([^\"']+)[\"'][^>]*>/i);\n    if (match?.[1]) return match[1];\n    \n    // 6. Data attributes\n    match = html.match(/data-published[-_]?(?:time|date)=[\"']([^\"']+)[\"']/i);\n    if (match?.[1]) return match[1];\n    \n    match = html.match(/data-date=[\"']([^\"']+)[\"']/i);\n    if (match?.[1]) return match[1];\n    \n    // 7. Twitter card meta tags\n    match = html.match(/<meta[^>]*name=[\"']twitter:data1[\"'][^>]*content=[\"']([^\"']+)[\"'][^>]*>/i);\n    if (match?.[1] && /\\d{4}/.test(match[1])) return match[1];\n    \n    // 8. Specific publisher formats\n    // WordPress\n    match = html.match(/<abbr[^>]*class=[\"'][^\"']*published[\"'][^>]*title=[\"']([^\"']+)[\"'][^>]*>/i);\n    if (match?.[1]) return match[1];\n    \n    // Medium\n    match = html.match(/data-post-published-at=[\"']([^\"']+)[\"']/i);\n    if (match?.[1]) return match[1];\n    \n    // 9. Look for ISO date patterns in the HTML (last resort)\n    // Matches formats like: 2024-01-15, 2024-01-15T10:30:00, etc.\n    const isoDateMatch = html.match(/\\b(20\\d{2}[-\\/](0[1-9]|1[0-2])[-\\/](0[1-9]|[12]\\d|3[01])(?:T[\\d:]+(?:\\.\\d+)?(?:Z|[+-]\\d{2}:\\d{2})?)?)\\b/);\n    if (isoDateMatch?.[1]) return isoDateMatch[1];\n    \n    return null;\n};\n\n// Extract the published date\nconst publishedDate = extractPublishedDate(htmlContent);\n\n// Return the result\nreturn {\n    publishedDate: publishedDate\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1360,
        648
      ],
      "id": "df194a10-0a1e-40a4-bb14-e96112719d31",
      "name": "extract date1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "9a8264bf-82d2-434f-b146-3b8deb76e519",
              "name": "title",
              "value": "={{ $('Merge').item.json.title }}",
              "type": "string"
            },
            {
              "id": "dfdf1695-e69f-4cff-a8f0-21d9da07745b",
              "name": "content",
              "value": "={{ ($('Merge').item.json.content || '').substring(0, 49000) }}",
              "type": "string"
            },
            {
              "id": "4899f665-2f29-41df-afea-d8a744a6fec9",
              "name": "url",
              "value": "={{ $('Merge').item.json.url }}",
              "type": "string"
            },
            {
              "id": "ec8500c3-9d57-45d3-b1a9-2de1706dee8d",
              "name": "summary",
              "value": "={{ $('Merge').item.json.summary }}",
              "type": "string"
            },
            {
              "id": "0c470796-e8e2-4605-a6af-9e8236d9635c",
              "name": "search_query",
              "value": "={{ $('Merge').item.json.search_query }}",
              "type": "string"
            },
            {
              "id": "4d34103a-b327-42cc-8e50-dec38a8fc1f5",
              "name": "publication_date",
              "value": "={{ $('Merge').item.json.publication_date }}",
              "type": "string"
            },
            {
              "id": "02065b1c-286c-4cf9-8709-27d8a766d2d1",
              "name": "prompt",
              "value": "={{ $('Merge').item.json.prompt }}",
              "type": "string"
            },
            {
              "id": "ef20184c-2ce1-4660-9658-fe12f9776f2d",
              "name": "additional_formats",
              "value": "={{ $('Merge').item.json.additional_formats }}",
              "type": "string"
            },
            {
              "id": "5a5e80cb-0ad3-4e06-86f8-63e9e59765fd",
              "name": "source",
              "value": "={{ $('Merge').item.json.source }}",
              "type": "string"
            },
            {
              "id": "61574df1-c16c-42df-9b9b-ebe428bd7eae",
              "name": "mode",
              "value": "={{ $('Merge').item.json.mode }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1360,
        1420
      ],
      "id": "14cb20bb-082d-400e-b180-eff5d555c86b",
      "name": "select fields"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -560,
        1080
      ],
      "id": "49513a91-11e7-4c67-ab4e-06ccba1c7007",
      "name": "Loop Over Items4"
    },
    {
      "parameters": {
        "mode": "combine",
        "advanced": true,
        "mergeByFields": {
          "values": [
            {
              "field1": "url",
              "field2": "URL"
            }
          ]
        },
        "joinMode": "keepNonMatches",
        "outputDataFrom": "input1",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        2288,
        1240
      ],
      "id": "a770d845-f4bb-417e-9bce-dcd20ec772e8",
      "name": "Remove Duplicates1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "4061f412-99c2-4549-9d2e-be355aa6a5bb",
              "name": "url",
              "value": "={{ $('select fields').item.json.url }}",
              "type": "string"
            },
            {
              "id": "60a2488f-d96c-4c21-94f1-6f627e9c99ae",
              "name": "title",
              "value": "={{ $('select fields').item.json.title }}",
              "type": "string"
            },
            {
              "id": "30183727-5e80-401c-a728-37da12a2054b",
              "name": "content",
              "value": "={{ $('select fields').item.json.content }}",
              "type": "string"
            },
            {
              "id": "ac7fb376-710f-43b5-9ff8-c3de8dc4f0ff",
              "name": "publication_date",
              "value": "={{ $('select fields').item.json.publication_date }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2000,
        1128
      ],
      "id": "68bc0595-2c2c-43ba-a0f9-f3cf246ccf2c",
      "name": "Set Google Sheet Fields"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1DGxbB-WIk_Ycv8W0iH7dXUo6ESu67ZqLNFhXB8w3-AI",
          "mode": "list",
          "cachedResultName": "Syntech Evaluation Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1DGxbB-WIk_Ycv8W0iH7dXUo6ESu67ZqLNFhXB8w3-AI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Evaluations",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1DGxbB-WIk_Ycv8W0iH7dXUo6ESu67ZqLNFhXB8w3-AI/edit#gid=0"
        },
        "options": {
          "dataLocationOnSheet": {
            "values": {
              "rangeDefinition": "detectAutomatically"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2000,
        1372
      ],
      "id": "ae2b6978-70a1-4e92-8a0f-2402ee797681",
      "name": "Get All Ideas From Evaluation Table2",
      "executeOnce": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "TvN6HmHHfgKukni4",
          "name": "Stephen Google Sheets account"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "d1a433e2-115c-4f9c-a258-7731b132de1c",
              "leftValue": "={{ $json.content }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2.2,
      "position": [
        -336,
        1080
      ],
      "id": "0e6cebe6-90a2-4f8b-9cba-43f465710be7",
      "name": "is content empty?"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "cc515966-f679-4152-a85b-f524bb588f34",
              "leftValue": "={{ $if($('sources').isExecuted, $('sources').item.json.bypass_filter, false) }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2512,
        1624
      ],
      "id": "b0dd165d-648c-440c-ba7d-dc5b93dbc089",
      "name": "If From Form1"
    },
    {
      "parameters": {
        "compare": "selectedFields",
        "fieldsToCompare": "url",
        "options": {}
      },
      "type": "n8n-nodes-base.removeDuplicates",
      "typeVersion": 2,
      "position": [
        -112,
        1080
      ],
      "id": "d26fc3b0-b067-4c1d-a788-193d7fa32abf",
      "name": "Remove Duplicates3"
    },
    {
      "parameters": {
        "sortFieldsUi": {
          "sortField": [
            {
              "fieldName": "output.relevance_score",
              "order": "descending"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.sort",
      "typeVersion": 1,
      "position": [
        688,
        944
      ],
      "id": "d76400b9-73bc-4879-9bb8-91d1ebdeef70",
      "name": "Sort"
    },
    {
      "parameters": {
        "maxItems": 10
      },
      "type": "n8n-nodes-base.limit",
      "typeVersion": 1,
      "position": [
        912,
        944
      ],
      "id": "6777b545-1141-4954-8ebd-c89733055806",
      "name": "Get 10 best articles"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "8987c495-abc2-4e29-86db-4466755af908",
              "leftValue": "={{ $('Classification agent with Batch1').item.json.output.relevance_score }}",
              "rightValue": 2,
              "operator": {
                "type": "number",
                "operation": "gt"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2.2,
      "position": [
        2736,
        1744
      ],
      "id": "1c6525d9-db86-44af-ad15-054e1ad24d47",
      "name": "Valid content only (score above 2)"
    },
    {
      "parameters": {
        "maxItems": 1000
      },
      "type": "n8n-nodes-base.limit",
      "typeVersion": 1,
      "position": [
        -1232,
        1080
      ],
      "id": "e6a03d1d-9f75-4c9b-8eeb-ea61fa097c9d",
      "name": "Limit1"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": {
          "__rl": true,
          "value": "27a785c0-cfab-807b-b5eb-e1214e18960d",
          "mode": "list",
          "cachedResultName": "Syntech Biofuels Static Sources",
          "cachedResultUrl": "https://www.notion.so/27a785c0cfab807bb5ebe1214e18960d"
        },
        "returnAll": true,
        "options": {}
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        -112,
        1972
      ],
      "id": "fbc85a6e-6999-48ff-9a06-8999bac6e29d",
      "name": "Get All Sources1",
      "credentials": {
        "notionApi": {
          "id": "v7nNI35XIwsY1JzB",
          "name": "Syntech.granite"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        344,
        1168
      ],
      "id": "d315fff1-f913-4c2d-b790-e99a74e522be",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "S2kEpGa9PHsoI7on",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.content }}",
        "hasOutputParser": true,
        "messages": {
          "messageValues": [
            {
              "message": "=<prompt>\n\n    <introduction>\n        You are an expert evaluator of sustainability and renewable fuel content.  \n        Your role is to assess how closely an article aligns with **Syntech Biofuel’s ecosystem, mission, and focus areas**.  \n        Syntech specializes in **advanced liquid biofuels** (B100, HVO, ASB, FAME) made from **waste streams**, emphasizing **UK-based innovation**, **decarbonisation**, and **drop-in diesel substitution**.  \n        Articles most relevant to Syntech discuss **UK waste-to-fuel systems**, **B100/B20/FAME deployment**, **RTFO-linked initiatives**, or **circular-economy biodiesel production**.\n    </introduction>\n\n    <task>\n        Assign a **relevance_score** from 0–5 showing how closely the article aligns with Syntech’s interests.  \n        Base this on:\n        1. **Centrality:** Are advanced biofuels, biodiesel, or waste-to-fuel systems the main topic?  \n        2. **Context:** Does it directly support Syntech’s UK-focused mission (e.g., decarbonising fleets with drop-in fuels)?  \n        3. **Brand Alignment:** Is it UK-based, waste-derived, and non-competitive in focus?  \n\n        Output only:\n        {\"relevance_score\": number, \"reason\": \"short factual explanation\"}\n    </task>\n\n    <keywords>\n        biodiesel, B100, B20, FAME, HVO, ASB, renewable diesel, advanced biofuel, waste-to-fuel, used cooking oil, UCO, tallow, drop-in diesel, drop-in fuel, decarbonisation, RTFO, greenhouse gas reduction, carbon intensity, circular economy, renewable fuel, Syntech Biofuel, biofuel refinery, renewable diesel plant, fleet fuel, waste-derived fuel, UK biofuel, UK renewable fuel, transport decarbonisation\n    </keywords>\n\n    <steps>\n        1. **Read the entire article** to determine its **primary focus**.  \n        2. **Identify keyword mentions** and classify them as:\n            - *Central*: Core topic of the article.  \n            - *Peripheral*: Minor or passing mention.  \n        3. **Prioritize topic centrality** over keyword count. A few central mentions are stronger than many irrelevant ones.  \n        4. **UK relevance check:**  \n            - Articles about UK projects, policy, or operations can reach scores of 4–5.  \n            - Global or general renewables content should cap at 3.  \n        5. **Exclude or penalize** content dominated by hydrogen, EVs, solar, wind, SAF, or biogas **unless explicitly linked** to **liquid biofuels or drop-in diesel**.  \n        6. **Downweight competitor or reseller content** (e.g., Green Fuels, Neste, Argent Energy) — cap at **1–2**.  \n        7. **Paywalled, teaser, or directory listings** cap at **1**.  \n        8. **Use <scoring_criteria> and <examples>** to guide final score assignment.  \n        9. Output only the JSON with `relevance_score` and `reason`.\n    </steps>\n\n    <scoring_criteria>\n        **0 — Unrelated:**  \n        No connection to advanced biofuels, Syntech’s ecosystem, or UK decarbonisation using drop-in fuels.  \n        *Examples:* hydrogen, EVs, solar, generic sustainability, aviation SAF.\n\n        **1 — Marginally Related:**  \n        Mentions sustainability or emissions reduction but lacks any link to biofuels or Syntech’s UK context.  \n        *Example:* general energy transition or decarbonisation article.\n\n        **2 — Slightly Related:**  \n        Brief reference to biofuels, renewable diesel, or B100, but not central; or focuses on competitors.  \n        *Example:* “Green Fuels launches new biodiesel” or global trade summary.\n\n        **3 — Partially Related:**  \n        Includes biofuels or waste-derived energy as part of a broader discussion, with limited UK focus.  \n        *Example:* UK energy overview mentioning biodiesel among other renewables.\n\n        **4 — Strongly Related:**  \n        Focuses on UK biofuel or waste-to-fuel projects, such as B100 or HVO fleet deployment, circular economy models, or RTFO compliance.  \n        *Example:* UK waste oil conversion to biodiesel or local decarbonisation initiative.\n\n        **5 — Highly Relevant:**  \n        Article is primarily about Syntech-aligned subjects: **UK waste-to-fuel production**, **B100/FAME/ASB innovation**, or **drop-in diesel substitution** supporting decarbonisation.  \n        *Example:* “Biodiesel produced in the UK from used cooking oil powers fleet vehicles.”\n    </scoring_criteria>\n\n    <brand_alignment_rules>\n        * **Upweight** UK-based coverage of B100, HVO, ASB, or circular-economy biodiesel.  \n        * **Upweight** articles that quantify decarbonisation or mention RTFO alignment.  \n        * **Downweight or exclude** hydrogen, EV, SAF, or non-liquid renewables unless explicitly linked to liquid fuels.  \n        * **Downweight** competitor or reseller marketing content.  \n        * **Cap** scores for vague, global, or teaser content lacking technical depth or UK linkage.\n    </brand_alignment_rules>\n\n    <examples>\n        **Example Scoring Anchors:**  \n        - *Score 0:* “Hydrogen fuel cells breakthrough” → unrelated to liquid biofuels.  \n        - *Score 1:* “Global decarbonisation trends” → generic sustainability, no biofuel focus.  \n        - *Score 2:* “Neste launches renewable diesel product” → relevant technology but competitor-focused.  \n        - *Score 3:* “UK clean energy overview mentioning biodiesel” → partial relevance.  \n        - *Score 4:* “Teesside fleet adopts B100 biodiesel from waste oil” → strongly aligned.  \n        - *Score 5:* “UK biodiesel produced from used cooking oil powers national fleets” → fully aligned with Syntech mission.\n    </examples>\n\n    <restrictions>\n        * Output must be **only** a valid JSON object with `relevance_score` and `reason`.  \n        * Keep reasoning factual, concise (1–2 sentences).  \n        * Do not output keyword data, markdown, or extra commentary.\n    </restrictions>\n\n    <output_rules>\n        {\"relevance_score\": 4, \"reason\": \"Article focuses on UK waste-derived biodiesel and B100 deployment for decarbonisation, directly aligned with Syntech’s mission.\"}\n        Output nothing else.\n    </output_rules>\n\n</prompt>\n"
            }
          ]
        },
        "batching": {
          "batchSize": 10,
          "delayBetweenBatches": 1000
        }
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        336,
        944
      ],
      "id": "3cda790a-91a4-492e-a0d1-62fe2bf5da3c",
      "name": "Classification agent with Batch1"
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"relevance_score\": {\n      \"type\": \"integer\",\n      \"description\": \"Relevance score from 0 to 5 indicating how closely the article aligns with Syntech Biofuel's focus\",\n      \"minimum\": 0,\n      \"maximum\": 5\n    },\n    \"reason\": {\n      \"type\": \"string\",\n      \"description\": \"Short factual explanation of the score (1-2 sentences maximum)\"\n    }\n  },\n  \"required\": [\"score\", \"reason\"]\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        472,
        1168
      ],
      "id": "2f48c5d3-5307-4cb9-b24d-6a927d3c1593",
      "name": "Structured Output Parser"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "8181b8db-969e-49ec-9489-805d0054391e",
              "leftValue": "={{ $if($('sources').isExecuted, $('sources').item.json.bypass_filter, false) }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "false",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2.2,
      "position": [
        1648,
        1240
      ],
      "id": "c2d9f2ae-b9f4-46e5-86e5-cf13796f6c36",
      "name": "filter"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=<content>\n{{ $json.linebreak }}\n</content>",
        "hasOutputParser": true,
        "messages": {
          "messageValues": [
            {
              "message": "=<prompt>\n    <task>\n        Your primary tasks are to analyze provided content and then generate a JSON object containing two key-value pairs:\n        1.  **title:** A compelling, benefit-driven title.\n        2.  **summary:** A concise and powerful summary of the key information.\n    </task>\n    \n    <steps>\n        1.  Thoroughly review all the key information provided.\n        2.  Identify the most critical benefits for the target audience (businesses with vehicle fleets, construction machinery, etc.).\n        3.  Distill this information into a clear, engaging summary, adhering strictly to the word count limit.\n        4.  Craft a short, impactful title that grabs attention and highlights the primary value proposition.\n        5.  Format the final output as a single JSON object.\n    </steps>\n\n    <restrictions>\n        - **Summary Word Count:** DO NOT exceed 50 words for the summary.\n        - **Tone:** AVOID jargon where possible. Focus on clear business benefits.\n        - **Clarity:** Ensure the 'drop-in' nature (no engine modification) is communicated as a key advantage of simplicity.\n        - **JSON Formatting:** The final output must be a single, valid JSON object enclosed in a markdown code block. Do not include any text before or after the JSON object.\n    </restrictions>\n\n    <output_rules>\n        - **Format:** A raw JSON object.\n        - **Keys:** The JSON object must contain exactly two keys: `title` and `summary`.\n        - **Values:** The values for both keys must be strings.\n        - **Tone:** The content of the strings must be professional, confident, and inspiring.\n    </output_rules>\n\n    <examples>\n        ### Example 1\n        **Input Content:** A press release detailing the launch of Syntech ASB and its ISCC certification.\n        **Output:**\n        ```json\n        {\n          \"title\": \"Immediately Cut Carbon Emissions by 90% with UK-Made Biofuel\",\n          \"summary\": \"Syntech ASB is a UK-made, ISCC-certified biofuel from 100% used cooking oil. As a simple drop-in fuel for any diesel engine, it helps businesses instantly reduce carbon emissions by up to 90% and meet Net Zero targets without new investment.\"\n        }\n        ```\n    </examples>\n\n</prompt>\n"
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        1936,
        648
      ],
      "id": "b6efde26-ab6a-4771-a103-ca17df03f5c3",
      "name": "Create summary and title"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-nano",
          "mode": "list",
          "cachedResultName": "gpt-4.1-nano"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        1944,
        872
      ],
      "id": "7403b4c6-234c-4050-9fcb-3cfd60d906f4",
      "name": "OpenAI Chat Model1",
      "credentials": {
        "openAiApi": {
          "id": "S2kEpGa9PHsoI7on",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"title\": {\n      \"type\": \"string\",\n      \"description\": \"A compelling, benefit-driven title\"\n    },\n    \"summary\": {\n      \"type\": \"string\",\n      \"description\": \"A concise summary (max 50 words)\"\n    }\n  },\n  \"required\": [\"title\", \"summary\"]\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        2072,
        872
      ],
      "id": "e254fa8c-d414-4cec-8a9a-de72b9fb16f4",
      "name": "Structured Output Parser2"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1DGxbB-WIk_Ycv8W0iH7dXUo6ESu67ZqLNFhXB8w3-AI",
          "mode": "list",
          "cachedResultName": "Syntech Evaluation Test",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1DGxbB-WIk_Ycv8W0iH7dXUo6ESu67ZqLNFhXB8w3-AI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Evaluations",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1DGxbB-WIk_Ycv8W0iH7dXUo6ESu67ZqLNFhXB8w3-AI/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Publication Date": "={{ $json.publication_date }}",
            "URL": "={{ $json.url }}",
            "Title": "={{ $json.title }}",
            "Content": "={{ $json.content }}",
            "Actual Score": "={{ $('Classification agent with Batch1').item.json.message.content.relevance_score }}",
            "AI Reasoning": "={{ $('Classification agent with Batch1').item.json.message.content.reasoning }}"
          },
          "matchingColumns": [
            "URL"
          ],
          "schema": [
            {
              "id": "Title",
              "displayName": "Title",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "URL",
              "displayName": "URL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Content",
              "displayName": "Content",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Publication Date",
              "displayName": "Publication Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Actual Score",
              "displayName": "Actual Score",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Expected Score",
              "displayName": "Expected Score",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Human Reasoning",
              "displayName": "Human Reasoning",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "AI Reasoning",
              "displayName": "AI Reasoning",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "useAppend": true
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2512,
        1276
      ],
      "id": "8e8fbe00-2789-4979-9be6-b30965a4193e",
      "name": "Add Content Idea to Evaluation Table1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "TvN6HmHHfgKukni4",
          "name": "Stephen Google Sheets account"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "operation": "setMetrics",
        "expectedAnswer": "={{ $('Run Evaluation').item.json.Expected_Score }}",
        "actualAnswer": "={{ $('Classification agent with Batch1').item.json.output.relevance_score }}",
        "prompt": "=You are an expert evaluator assessing how closely an actual score matches the expected score.\n\nCompare the expected and actual scores numerically, then assign a final similarity rating from 0 to 5 according to the following scale:\n\n# Scoring Criteria\n- 5: Perfect match – actual and expected scores are identical.\n- 4: Very close – difference of 1 point.\n- 3: Somewhat close – difference of 2 points.\n- 2: Noticeably different – difference of 3 points.\n- 1: Highly different – difference of 4 points.\n- 0: Completely misaligned or invalid comparison – difference greater than 4 or one score missing.\n\n# Output Format\nOnly output the final score in strict JSON format as follows:\n{\n  \"score\": <integer from 0 to 5>\n}\n\nDo not include any reasoning, explanation, or additional text.\n",
        "options": {}
      },
      "type": "n8n-nodes-base.evaluation",
      "typeVersion": 4.8,
      "position": [
        1584,
        840
      ],
      "id": "3c931160-06b1-4942-8dd8-1725734f4d6e",
      "name": "Evaluation1"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        1656,
        1064
      ],
      "id": "b5b89914-2e7b-4550-9ab3-26662a8ebfe0",
      "name": "OpenAI Chat Model8",
      "credentials": {
        "openAiApi": {
          "id": "S2kEpGa9PHsoI7on",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "content": "## I'm a note \nWhat would we like to know about the data that we're assessing?\n* impact eg positive, negative, neutral",
        "height": 144,
        "width": 304
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        288,
        768
      ],
      "id": "44be15de-18a7-4d97-8e63-69184b266c10",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "## I'm a note \nAre we just scraping everything on a daily basis to check and make sure we're always alert?\n\nAlways check everything ✅",
        "height": 208
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1872,
        880
      ],
      "id": "df2e6d94-70c1-4366-86f6-11d87f6c69af",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "## I'm a note \nIf we do go down the evaluation route, what would we like to ensure the system is doing?"
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1568,
        496
      ],
      "id": "f748921b-711c-4bbc-b351-32483339d3fa",
      "name": "Sticky Note2"
    }
  ],
  "pinData": null,
  "repo_name": "syntech-backup-railway",
  "repo_owner": "Granite-Marketing",
  "repo_path": "https://github.com/Granite-Marketing/syntech-n8n-backup/",
  "settings": {
    "executionOrder": "v1",
    "callerPolicy": "workflowsFromSameOwner",
    "availableInMCP": false,
    "timeSavedPerExecution": 120
  },
  "shared": [
    {
      "updatedAt": "2026-01-28T09:06:07.192Z",
      "createdAt": "2026-01-28T09:06:07.192Z",
      "role": "workflow:owner",
      "workflowId": "RjoxltBC5OFVdmmg",
      "projectId": "U9sMeJya1DaokkjK"
    }
  ],
  "staticData": {
    "node:Schedule Trigger": {
      "recurrenceRules": [
        282
      ]
    },
    "node:Schedule Trigger1": {
      "recurrenceRules": []
    }
  },
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2026-01-28T09:06:07.192Z",
  "versionId": "fdb652ab-064b-4622-abac-765dd88f160c"
}