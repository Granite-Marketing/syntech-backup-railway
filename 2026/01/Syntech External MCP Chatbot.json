{
  "active": false,
  "activeVersion": null,
  "activeVersionId": null,
  "connections": {
    "Simple Memory1": {
      "ai_memory": [
        []
      ]
    },
    "get_platform_content_prompt": {
      "ai_tool": [
        [
          {
            "node": "write_platform_content",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Curate Sources": {
      "ai_tool": [
        [
          {
            "node": "get_topic_research_context",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Generate Search Queries2": {
      "ai_tool": [
        [
          {
            "node": "get_topic_research_context",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Search Internet2": {
      "ai_tool": [
        [
          {
            "node": "get_topic_research_context",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "get_topic_research_context": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory2": {
      "ai_memory": [
        []
      ]
    },
    "write_platform_content": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Anthropic Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "get_topic_research_context",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Anthropic Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "write_platform_content",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "start_content_work_item": {
      "ai_tool": [
        [
          {
            "node": "sync_content_workflow_state",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "cancel_content_work_item": {
      "ai_tool": [
        [
          {
            "node": "sync_content_workflow_state",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "complete_content_work_item": {
      "ai_tool": [
        [
          {
            "node": "sync_content_workflow_state",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Anthropic Chat Model2": {
      "ai_languageModel": [
        [
          {
            "node": "sync_content_workflow_state",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory3": {
      "ai_memory": [
        []
      ]
    },
    "sync_content_workflow_state": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "revise_platform_content": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Anthropic Chat Model3": {
      "ai_languageModel": [
        [
          {
            "node": "revise_platform_content",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Get New Ideas1": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Get New Ideas (From Time Period)1": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "get_workflow_states_by_notion_ids": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "get_workflow_items_by_status": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2026-01-28T08:26:51.134Z",
  "id": "HymQjTiMWoM1RyJU",
  "isArchived": false,
  "meta": null,
  "name": "Syntech External MCP Chatbot",
  "nodes": [
    {
      "parameters": {
        "contextWindowLength": 1
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        -560,
        736
      ],
      "id": "3423e3b6-417e-4a24-8f17-ca7897d92fd8",
      "name": "Simple Memory1"
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "=Use this tool to retrieve a platform-specific content writing prompt.\n\nThis tool returns prompts that define:\n- Writing style\n- Structure\n- Tone\n- Length constraints\n- Formatting rules\n\nYou MUST call this tool before writing any content.\n\nInputs:\n- platform (required): The target platform or content type (e.g. LinkedIn, Twitter/X, Blog, Newsletter)\n- content_type (optional): Post, article, thread, long-form blog, etc.\n\nOutput:\n- One or more writing prompts designed to be used as instructions for generating content.\n- These prompts are NOT final content and must be applied to the user-provided idea.\n\nIf a relevant prompt is found, select the best one and use it to generate the final content.\nIf no relevant prompt is found, do not generate content.",
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": {
          "__rl": true,
          "value": "27c785c0-cfab-810e-9c97-cefeee3d04b3",
          "mode": "list",
          "cachedResultName": "Syntech Platform Prompts",
          "cachedResultUrl": "https://www.notion.so/27c785c0cfab810e9c97cefeee3d04b3"
        },
        "filterType": "manual",
        "filters": {
          "conditions": [
            {
              "key": "Title|title",
              "condition": "contains",
              "titleValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('conditions0_Title', `The content prompt that the user want's to use to generate content. Input should only contain the platform name eg \"LinkedIn\", \"Threads\", \"Twitter/X\", \"Blog\" ...`, 'string') }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.notionTool",
      "typeVersion": 2.2,
      "position": [
        -400,
        736
      ],
      "id": "2b2d3016-e5fd-42e7-b5ff-998bfe3ae817",
      "name": "get_platform_content_prompt",
      "credentials": {
        "notionApi": {
          "id": "v7nNI35XIwsY1JzB",
          "name": "Syntech.granite"
        }
      }
    },
    {
      "parameters": {
        "name": "curate_sources",
        "description": "Call this tool to curate the best URLs from the generate_search_queries. The input should be the list of URLs from the generate_search_queries tool. ",
        "workflowId": {
          "__rl": true,
          "value": "EAPhQjGU2ySyEXs7",
          "mode": "list",
          "cachedResultUrl": "/workflow/EAPhQjGU2ySyEXs7",
          "cachedResultName": "Curate Sources"
        },
        "fields": {
          "values": [
            {
              "name": "question",
              "stringValue": "={{ $fromAI('initial_input', \"The user-provided topic to be researched\") }}"
            },
            {
              "name": "max_results",
              "stringValue": "=3"
            },
            {
              "name": "in_depth",
              "type": "booleanValue"
            }
          ]
        },
        "jsonSchemaExample": ""
      },
      "id": "02780777-1491-4da8-ad36-fcea8e73cc57",
      "name": "Curate Sources",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 1.2,
      "position": [
        -1344,
        640
      ]
    },
    {
      "parameters": {
        "name": "generate_search_queries",
        "description": "Generates the search queries prompt for the given question and context.\nArgs:\n        question (str): The question to generate the search queries prompt for\n        report_type (str): The report type\n        max_iterations (int): The maximum number of search queries to generate\n        context (str): Context for better understanding of the task with realtime web information provided by calling the 'get_content' tool\n\nReturns: str: The search queries prompt for the given question",
        "workflowId": {
          "__rl": true,
          "value": "3ZvtNy32wVNLZjZO",
          "mode": "list",
          "cachedResultUrl": "/workflow/3ZvtNy32wVNLZjZO",
          "cachedResultName": "Generate Search Queries"
        },
        "fields": {
          "values": [
            {
              "name": "question",
              "stringValue": "={{ $fromAI('initial_input', \"The user-provided topic to be researched\") }}"
            },
            {
              "name": "report_type",
              "stringValue": "=ada"
            },
            {
              "name": "max_iterations",
              "stringValue": "=3"
            }
          ]
        },
        "specifyInputSchema": true,
        "schemaType": "manual",
        "inputSchema": "{\n\"type\": \"object\",\n\"properties\": {\n\t\"query\": {\n\t\t\"type\": \"string\",\n\t\t\"description\": \"The query generated by the agent\"\n    },\n    \"context\": {\n  \t\t\"type\": \"string\",\n  \t\t\"description\": \"The output generated by calling the 'get_contet' tool\"\n    }\n  }\n}"
      },
      "id": "46472c36-9451-4786-bf48-7066cba239e3",
      "name": "Generate Search Queries2",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 1.2,
      "position": [
        -1184,
        640
      ]
    },
    {
      "parameters": {
        "toolDescription": "Useful for searching search queries generated by the agent. ",
        "method": "POST",
        "url": "https://api.tavily.com/search",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n    \"api_key\": \"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\",\n    \"query\": \"{query}\",\n}",
        "placeholderDefinitions": {
          "values": [
            {
              "name": "query",
              "description": "The query provided by the Agent"
            }
          ]
        },
        "optimizeResponse": true,
        "dataField": "results",
        "fieldsToInclude": "selected",
        "fields": "title, url, content, score"
      },
      "id": "cb55c519-6e82-4ee9-859f-d51991e2e989",
      "name": "Search Internet2",
      "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
      "typeVersion": 1.1,
      "position": [
        -1008,
        640
      ]
    },
    {
      "parameters": {
        "toolDescription": "=Use this tool to retrieve factual background, key points, and recent context for a given topic.\n\nThis tool is for research only.\nIt returns raw informational context, not finished content.\n\nInputs:\n- topic or source material\n- optional scope (e.g. policy, economics, climate, technology)\n\nOutput:\n- Bullet-point facts\n- Key arguments\n- Important statistics or developments\n- Neutral, source-based context\n\nThis output is intended to be passed into a writing agent as background material.",
        "text": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Prompt__User_Message_', ``, 'string') }}",
        "options": {
          "systemMessage": "=You are responsible for managing and coordinating researching the users query.\n\n# Objectives\n- Prioritise UK sources first; include EU/global only when UK data is unavailable or to add context.\n- Default to the most recent information, ideally within the last 24 months, unless citing foundational standards or landmark studies.\n- Emphasise factual, standards-led, and operationally relevant information (e.g., BS EN 14214, RTFO, on-site/on-time deployment, measurable emissions impact).\n- Exclude partisan commentary and political opinion pieces. Factual policy/regulatory materials are allowed.\n- Prefer credible sources: government, standards bodies, peer-reviewed research, and recognised industry research. Include high-quality industry/blog sources when they present verifiable data or methodology.\n\n# Steps\n\n1. **Initial orientation search (single-query only)**  \n   Perform **one** broad web search to gain a *high-level background understanding* of the topic:  \n   \"{{ $fromAI('initial_input', \"The user-provided topic to be researched\") }}\"\n\n   - This step is for orientation only, not exhaustive research.\n   - Do NOT generate multiple queries at this stage.\n   - Do NOT branch, refine, or iterate searches.\n   - The purpose is to understand key themes, terminology, standards, and entities.\n\n2. Use the context from the initial orientation search to generate structured search queries.\n\n3. Search the internet with the queries generated by the generate_search_queries tool.\n\n4. Curate the best URLs from step 3.\n\n# Tools Available\n\"generate_search_queries\": Create structured search queries based on initial context\n\"search_internet\": Obtain real-time web data\n\"curate_sources\": Evaluate and curate the best URLs from the research_search_queries tool\n\n# Output and Quality Notes\n- Capture sources that include measurable outcomes, standards/regulatory references, supply-chain/ESG implications, and concrete data.\n- Avoid redundancy; include overlapping sources only if each adds novel data, methodology, or perspective.\n- Note paywalls or inaccessible pages; prefer accessible sources for extraction and citation.\n- Assume todays date is {{ $now }}.",
          "maxIterations": 30,
          "returnIntermediateSteps": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agentTool",
      "typeVersion": 2.2,
      "position": [
        -1232,
        432
      ],
      "id": "01bf5ab3-8e56-4f21-a520-a3e533dc0a84",
      "name": "get_topic_research_context"
    },
    {
      "parameters": {
        "contextWindowLength": 2
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        -1504,
        640
      ],
      "id": "7530fb53-3f4a-42f1-954b-e37300fa997d",
      "name": "Simple Memory2"
    },
    {
      "parameters": {
        "toolDescription": "=## Tool: Write Platform Content\n\nUse this tool to generate final, ready-to-publish content for a specific platform.\n\nThis tool is execution-only.  \nIt does not perform research, planning, or prompt selection.\n\n---\n\n### Usage Requirements\n\nYou must use this tool only after:\n\n- A **platform-specific writing prompt** has been retrieved using the target platform name  \n- Any optional research context has been gathered (if available or needed)\n\n---\n\n### Inputs\n\n- **content_idea** (required): The core idea or brief for the content  \n- **platform** (required): The target platform (e.g. Blog, LinkedIn, Twitter/X)  \n- **writing_prompt** (required): A platform-specific prompt retrieved based solely on the platform  \n- **research_context** (optional): Factual background or key points provided by a research tool  \n- **optional_modifiers** (optional): Audience, tone, length, CTA, or other constraints\n\n---\n\n### Behavior\n\n- Apply the `writing_prompt` as the primary instruction set  \n- Do **not** evaluate topic, audience, or subject fit  \n- Incorporate `research_context` if provided  \n- Adapt to any `optional_modifiers` (tone, CTA, etc.)  \n- Always write in English\n\n---\n\n### Output\n\n- Return **only the final written content**  \n- Do **not** include:\n  - Tool descriptions  \n  - Prompt references  \n  - Metadata  \n  - Explanations or formatting notes\n\n---\n\n### Failure Conditions (Strict)\n\nThis tool must **only** refuse to generate content if:\n\n- `writing_prompt` is missing or no prompt exists for the given `platform`\n\nIn that case, return:\n\n> No writing prompt is configured for this platform.\n\nDo **not** reject based on topic, audience, or brand mismatch.  \nDo **not** perform suitability checks or apply fallback logic.\n\n---\n\nThis tool generates content using a prompt tied directly to the named platform.  \nIt does not determine content appropriateness — it executes.",
        "text": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Prompt__User_Message_', `You will receive structured inputs in the following format:\n\n- **content_idea** (required): A description or brief of the content to be written\n- **platform** (required): The name of the platform (e.g. Blog, LinkedIn, Twitter/X)\n- **writing_prompt** (required): A platform-specific writing prompt (already retrieved) that defines tone, voice, and structure\n- **research_context** (optional): Background facts or factual input to guide the writing\n- **optional_modifiers** (optional): Instructions like tone, length, CTA, or specific angles to focus on\n\nAlways use the provided \\`writing_prompt\\` without evaluating or modifying it.`, 'string') }}",
        "options": {
          "systemMessage": "=# System Prompt — Platform Content Writer Agent\n\nYou are a specialized content-writing agent used by a main orchestrator agent.\n\nYour sole responsibility is to generate final-form content using a platform-specific writing prompt that has already been retrieved for you.\n\nYou do not retrieve prompts.  \nYou do not inspect or evaluate prompt content.  \nYou do not judge whether the prompt “fits” the topic, audience, or brand.  \nYou simply apply the provided prompt to generate content.\n\n---\n\n## Inputs You Will Receive\n\nYou will receive the following structured inputs:\n\n- **content_idea** (required): A short brief or summary of what the content should cover\n- **platform** (required): The platform the content is intended for (e.g. Blog, LinkedIn, Twitter/X)\n- **writing_prompt** (required): A platform-specific prompt that defines structure, tone, and style\n- **research_context** (optional): Background facts or factual context to include\n- **optional_modifiers** (optional): Style, tone, CTA, or length preferences\n\n---\n\n## Prompt Usage Rules (STRICT)\n\n- The `writing_prompt` has already been selected for you based on the platform\n- You must use it as the **primary instruction set** for generating the content\n- You are not allowed to:\n  - Reject the prompt for being too specific\n  - Modify or ignore the prompt\n  - Compare the prompt to the topic or brand\n  - Ask the user to confirm or override the prompt\n\nThe prompt must be applied exactly as given.\n\n---\n\n## Content Generation Rules\n\n- Use the `writing_prompt` as the governing style and structure\n- Adapt to `optional_modifiers` if provided\n- Use `research_context` to inform accuracy, not tone\n- Always write in **English**\n- Output must follow platform-specific style conventions implied by the prompt\n\n---\n\n## Output Rules\n\n- Return **only** the final written content\n- Do **not** include:\n  - Internal reasoning\n  - Metadata or debug information\n  - Explanations or tool references\n\n---\n\n## Failure Handling (Strict)\n\nYou may only refuse to generate content if:\n\n- The `writing_prompt` input is **missing or empty**\n\nIn that case, respond with:\n\n> No writing prompt is configured for this platform.\n\nYou must not refuse or delay content generation for any other reason.\n\n---\n\n## Forbidden Behavior (Do Not Do This)\n\nYou must **never**:\n\n- Inspect or comment on the persona, brand, or tone of the prompt\n- Compare the topic or content idea to the prompt\n- Ask the user to confirm, adjust, or override the prompt\n- Skip prompt usage based on mismatch concerns\n- Write without using the prompt\n\n---\n\n## Summary\n\nYou are not a prompt evaluator.  \nYou are not a topic validator.  \nYou are a final-stage content generator.  \nIf a prompt is provided, you must use it without exception.",
          "returnIntermediateSteps": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agentTool",
      "typeVersion": 2.2,
      "position": [
        -608,
        528
      ],
      "id": "b2db544e-9f45-40bc-bc64-0cdeafa77d55",
      "name": "write_platform_content"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "claude-haiku-4-5-20251001",
          "mode": "list",
          "cachedResultName": "Claude Haiku 4.5"
        },
        "options": {
          "temperature": 0.2
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        -1680,
        640
      ],
      "id": "827b79fc-6edd-44f4-ae9d-c0e95355a2f3",
      "name": "Anthropic Chat Model",
      "credentials": {
        "anthropicApi": {
          "id": "uv5ovuIM0W5fmRTp",
          "name": "Stephen Anthropic account"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "claude-sonnet-4-5-20250929",
          "cachedResultName": "Claude Sonnet 4.5"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        -720,
        736
      ],
      "id": "b93d9dd0-3bda-421f-84f5-3603f8865ef5",
      "name": "Anthropic Chat Model1",
      "credentials": {
        "anthropicApi": {
          "id": "uv5ovuIM0W5fmRTp",
          "name": "Stephen Anthropic account"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "=Use this tool to claim a content idea and mark it as actively being worked on.\n\nThis tool should be called immediately after a content idea is selected from the content database\nand the user has confirmed they want to proceed.\n\nPurpose:\n- Create a new workflow record for the selected content idea\n- Set the workflow state to IN_PROGRESS\n- Prevent duplicate or parallel work on the same idea\n\nWhen to call:\n- After retrieving a content idea from Notion\n- After confirming the user wants to begin working on it\n- Before any research or writing begins\n\nInputs:\n- notion_page_id (required): The unique ID of the Notion content idea\n- notion_url (required): The URL of the Notion page\n- title (required): The title or name of the content idea\n- topic_signature (optional): A stable topic identifier for deduplication or analytics\n\nBehavior:\n- Creates a new content work item if none exists in progress\n- Marks the item as IN_PROGRESS\n- Records the start timestamp\n\nDo not call this tool:\n- If the user has not confirmed they want to proceed\n- If the user has declined to cancel an existing IN_PROGRESS item",
        "tableId": "content_work_items",
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "notion_page_id",
              "fieldValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('fieldValues0_Field_Value', `This is the Notion page ID obtained from getting content ideas e.g. \n\"2b9785c0-cfab-8144-a4c3-f8f635398751\"`, 'string') }}"
            },
            {
              "fieldId": "title",
              "fieldValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('fieldValues1_Field_Value', `This is the Notion page title obtained from getting content ideas \"Protect Your Business with New Countervailing Duties on US HVO Biodiesel\"`, 'string') }}"
            },
            {
              "fieldId": "status",
              "fieldValue": "IN_PROGRESS"
            },
            {
              "fieldId": "notion_url",
              "fieldValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('fieldValues3_Field_Value', `This is the Notion page URL obtained from getting content ideas e.g. \n\"https://www.notion.so/Protect-Your-Business-with-New-Countervailing-Duties-on-US-HVO-Biodiesel-2b9785c0cfab8144a4c3f8f635398751\"`, 'string') }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabaseTool",
      "typeVersion": 1,
      "position": [
        976,
        416
      ],
      "id": "faf73ef8-bbc7-42bc-8f65-ab12cb3a6ccf",
      "name": "start_content_work_item",
      "credentials": {
        "supabaseApi": {
          "id": "WzRqvoBujG4ARKMR",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "=Use this tool to explicitly cancel an in-progress content work item.\n\nThis tool represents an intentional abandonment of a content idea\nand must only be called after clear user confirmation.\n\nPurpose:\n- Mark a content work item as CANCELLED\n- Record that work was intentionally stopped\n- Allow new content work to begin\n\nWhen to call:\n- When the user explicitly chooses to cancel an in-progress item\n- When the user declines to continue or revise the current draft\n- Before starting a different content idea\n\nInputs:\n- notion_page_id (required): The Notion page ID associated with the work item\n- cancel_reason (optional): A short explanation for why the work was cancelled\n\nBehavior:\n- Updates the work item state to CANCELLED\n- Records the cancellation timestamp and optional reason\n\nDo not call this tool:\n- Without explicit user confirmation\n- For temporary pauses or revisions\n- To resolve system errors or timeouts",
        "operation": "update",
        "tableId": "content_work_items",
        "filters": {
          "conditions": [
            {
              "keyName": "id",
              "condition": "eq",
              "keyValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('conditions0_Field_Value', `Supabase Record ID (Required)\nThis MUST be the id returned by the start_content_work_item or get_current_in_progress_work_item tool.\n\nThis is NOT the Notion page ID.\nNotion IDs must never be used to update, cancel, or complete workflow state.`, 'string') }}"
            }
          ]
        },
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "status",
              "fieldValue": "=CANCELLED"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabaseTool",
      "typeVersion": 1,
      "position": [
        1200,
        416
      ],
      "id": "9b02af6e-16c2-44c8-82ad-c389f23303ef",
      "name": "cancel_content_work_item",
      "credentials": {
        "supabaseApi": {
          "id": "WzRqvoBujG4ARKMR",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "=Use this tool to mark a content work item as successfully completed.\n\nThis tool indicates that content has been created and approved for downstream actions\nsuch as publishing or attaching the content back to Notion.\n\nPurpose:\n- Mark a content work item as COMPLETED\n- Signal that writing is finished and approved\n- Enable follow-on workflows (publishing, notifications, analytics)\n\nWhen to call:\n- After the final content has been generated\n- After the user confirms they are happy with the content\n- Before or immediately after updating the corresponding Notion page\n\nInputs:\n- notion_page_id (required): The Notion page ID associated with the work item\n- completion_notes (optional): Any notes relevant to completion or handoff\n\nBehavior:\n- Updates the work item state to COMPLETED\n- Records the completion timestamp\n\nDo not call this tool:\n- If the user has not approved the content\n- If the content is still being revised\n- If writing failed or was abandoned",
        "operation": "update",
        "tableId": "content_work_items",
        "filters": {
          "conditions": [
            {
              "keyName": "id",
              "condition": "eq",
              "keyValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('conditions0_Field_Value', `Supabase Record ID (Required)\nThis MUST be the id returned by the start_content_work_item or get_current_in_progress_work_item tool.\n\nThis is NOT the Notion page ID.\nNotion IDs must never be used to update, cancel, or complete workflow state.`, 'string') }}"
            }
          ]
        },
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "status",
              "fieldValue": "COMPLETED"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabaseTool",
      "typeVersion": 1,
      "position": [
        1408,
        416
      ],
      "id": "db961157-089d-424a-940c-1f96a9a326fb",
      "name": "complete_content_work_item",
      "credentials": {
        "supabaseApi": {
          "id": "WzRqvoBujG4ARKMR",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "claude-haiku-4-5-20251001",
          "mode": "list",
          "cachedResultName": "Claude Haiku 4.5"
        },
        "options": {
          "temperature": 0
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        576,
        416
      ],
      "id": "155c2c30-8a3e-463b-b165-0023e8c34b09",
      "name": "Anthropic Chat Model2",
      "credentials": {
        "anthropicApi": {
          "id": "uv5ovuIM0W5fmRTp",
          "name": "Stephen Anthropic account"
        }
      }
    },
    {
      "parameters": {
        "contextWindowLength": 6
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        752,
        416
      ],
      "id": "cfe267ae-9e53-4bcf-b34a-63bf9cd19079",
      "name": "Simple Memory3"
    },
    {
      "parameters": {
        "toolDescription": "=Use this tool to synchronise workflow state across internal storage (Supabase) and the Notion content database.\n\nThis tool is responsible for all side effects related to content lifecycle state.\nThe orchestrator must not directly update Supabase or Notion.\n\nPurpose:\n- Keep workflow state consistent between Supabase and Notion\n- Abstract all database and Notion mutations behind a single capability\n- Ensure clear, auditable lifecycle transitions for content ideas\n\nWhen to call:\n- When a content idea is claimed and work begins\n- When an in-progress content item is explicitly cancelled\n- When content creation is completed and approved\n\nInputs:\n- action (required): One of:\n  - \"start\" — mark the content idea as in progress\n  - \"cancel\" — abandon the content idea\n  - \"complete\" — mark the content as completed\n- notion_page_id (required): The Notion page ID of the content idea\n- notion_url (required for start): The Notion page URL\n- title (required for start): The content idea title\n- topic_signature (optional): Stable topic identifier\n- cancel_reason (optional): Reason for cancellation\n- completion_notes (optional): Notes relevant to completion or handoff\n\nBehavior:\n- Executes the correct Supabase state transition\n- Updates the corresponding Notion status to reflect the same lifecycle stage\n- Ensures Supabase and Notion remain in sync\n\nDo not call this tool:\n- For drafting, research, or writing content\n- Without explicit user confirmation for cancellation or completion\n- To partially update state or metadata\n\nThis tool represents an intentional lifecycle transition, not a generic update.",
        "text": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Prompt__User_Message_', ``, 'string') }}",
        "options": {
          "systemMessage": "=You are a specialized workflow state manager.\n\nYour sole responsibility is to synchronise content lifecycle state\nacross internal storage (Supabase) and the Notion content database.\n\nYou do not:\n- Write content\n- Perform research\n- Decide what action to take\n- Ask the user questions\n\nYou only execute explicit state transition instructions\nprovided by the orchestrator.\n\n---\n\n## Supported Actions\n\nYou support exactly three actions:\n\n1. **start**\n   - Create a new workflow record in Supabase\n   - Set the workflow state to IN_PROGRESS\n   - Update the Notion item status to indicate it has been sent to the agent\n     or is actively being worked on\n\n2. **cancel**\n   - Update the Supabase workflow state to CANCELLED\n   - Update the Notion item status to reflect cancellation or reset state\n   - Record the cancellation reason if provided\n\n3. **complete**\n   - Update the Supabase workflow state to COMPLETED\n   - Update the Notion item status to indicate content has been created\n   - Prepare the item for downstream workflows such as publishing\n\n---\n\n## Execution Rules\n\n- Perform Supabase updates before Notion updates\n- Ensure both systems reflect the same lifecycle stage\n- Do not skip required steps\n- Do not infer intent or change action types\n- If an operation fails, stop and return the error\n\n---\n\n## Output Rules\n\n- Return a concise confirmation of the action performed\n- Do not include explanations, reasoning, or implementation details\n- Do not expose database schemas or internal logic\n\n---\n\nYou are a state synchronisation layer.\nYou exist to ensure consistency, not to make decisions.",
          "returnIntermediateSteps": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agentTool",
      "typeVersion": 2.2,
      "position": [
        768,
        208
      ],
      "id": "3964c4e3-cd87-456e-bdd5-e6560223f159",
      "name": "sync_content_workflow_state"
    },
    {
      "parameters": {
        "toolDescription": "=Use this tool to revise or refine existing content based on explicit user feedback.\n\nThis tool is for targeted edits only and must not trigger content creation workflows,\nresearch, or lifecycle state changes.\n\nPurpose:\n- Apply user-requested revisions to existing content\n- Modify only the relevant sections without rewriting the entire piece\n- Preserve the original structure, intent, and voice unless explicitly instructed otherwise\n\nWhen to call:\n- When the user provides existing content and asks to edit, tweak, refine, shorten, expand,\n  rephrase, or adjust specific parts\n- When the user gives feedback on a draft and wants changes applied\n- When the user explicitly requests revisions instead of new content\n\nInputs:\n- existing_content (required): The full current version of the content\n- revision_instructions (required): The user’s specific feedback or requested changes\n- optional_constraints (optional): Tone, length limits, audience notes, or style constraints\n\nBehavior:\n- Applies only the requested changes\n- Leaves unaffected sections unchanged\n- Does not add new sections unless explicitly requested\n- Does not perform research\n- Does not access content prompts or external data\n- Does not modify workflow or Notion state\n\nDo not call this tool:\n- To create new content from an idea\n- To significantly restructure or rewrite an article unless explicitly requested\n- When research or new background information is required\n- When the user has not provided existing content\n\nThis tool is for revisions, not creation.",
        "text": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Prompt__User_Message_', ``, 'string') }}",
        "options": {
          "systemMessage": "=# System Prompt — Content Revision Agent\n\nYou are a specialized content revision agent.\n\nYour sole responsibility is to revise existing content based on explicit user feedback.\nYou do not create new content from scratch.\n\n---\n\n## Core Responsibilities\n\n- Apply targeted revisions to the provided content\n- Follow the user’s revision instructions precisely\n- Preserve the original structure, tone, and intent unless explicitly instructed otherwise\n- Modify only the sections necessary to fulfil the request\n\n---\n\n## Strict Rules\n\n- Do NOT perform research\n- Do NOT add new factual claims\n- Do NOT rewrite the entire article unless explicitly asked\n- Do NOT change sections that are not mentioned or implied in the revision instructions\n- Do NOT access platform prompts or workflow state\n- Do NOT ask clarifying questions unless the instructions are ambiguous\n\n---\n\n## Revision Behavior\n\n- Prefer minimal, surgical edits over broad rewrites\n- Maintain continuity of voice and style\n- If instructions conflict, prioritize:\n  1. Explicit user feedback\n  2. Clarity and correctness\n  3. Minimal disruption to the existing content\n\n---\n\n## Output Rules\n\n- Return only the revised content\n- Do not include explanations, commentary, or change logs\n- Do not reference the original instructions or internal reasoning\n\n---\n\nYou are a precision editor, not a writer or researcher.",
          "returnIntermediateSteps": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agentTool",
      "typeVersion": 2.2,
      "position": [
        -80,
        544
      ],
      "id": "59d91b77-1a9d-4eaa-98fb-fdccefb96cb7",
      "name": "revise_platform_content"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "claude-sonnet-4-5-20250929",
          "cachedResultName": "Claude Sonnet 4.5"
        },
        "options": {
          "temperature": 0.3
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        -96,
        720
      ],
      "id": "e1f46694-98a7-4e4e-82ad-b1d9b24e9eeb",
      "name": "Anthropic Chat Model3",
      "credentials": {
        "anthropicApi": {
          "id": "uv5ovuIM0W5fmRTp",
          "name": "Stephen Anthropic account"
        }
      }
    },
    {
      "parameters": {
        "content": "## Research Agent\nResearches the content idea and curates the 3 best sources",
        "height": 480,
        "width": 896
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1728,
        384
      ],
      "id": "f336b35d-5263-433e-a3b4-36ea93ec5e07",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "## Writes content using Notion Prompts\nThis agent writes content using the prompts stored in notion. It uses keyword search eg if someone asks for \"write me a linkedIn post about xyz\", the system would filter for prompts with the title \"linkedIn\" in them",
        "height": 512,
        "width": 592,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -800,
        384
      ],
      "id": "5e884d4e-7807-4301-a50d-392201a8430a",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "## Revise Content\nThis agent revises existing content. It helps prevent accidentally doing more research or writing fresh content when user makes revision request",
        "height": 496,
        "width": 480,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -176,
        384
      ],
      "id": "b5a5cf79-e2eb-4cf4-b72e-807491bea27b",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "## Handle State\nThese tools help the system handle state as we create content using ideas from the Notion database\n### Features:\n* Start Content: Used when new content idea is being written about (IN_PROGRESS)\n* Cancel Content: If user cancels the content writing process (CANCELLED)\n* Complete Content: IF user completed the process. This value is used to update the Notion record so we know content has been written\n* Get Current State: Finds the IN_PROGRESS items to prevent duplication and loss of context since 'Cancel' and 'Complete' require record ID's",
        "height": 688,
        "width": 1216,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        720,
        -48
      ],
      "id": "90e64dff-8b89-4140-84f2-3c7aa605f3b0",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "path": "33cbc61f-3cf4-43a0-a22d-62dd4de5cc1e"
      },
      "type": "@n8n/n8n-nodes-langchain.mcpTrigger",
      "typeVersion": 2,
      "position": [
        -464,
        -32
      ],
      "id": "f644647c-e89d-47ff-8ef4-b5d4ea2beca7",
      "name": "MCP Server Trigger",
      "webhookId": "33cbc61f-3cf4-43a0-a22d-62dd4de5cc1e"
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "Call this tool to find all \"new\" article ideas from the content ideas Notion database",
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": {
          "__rl": true,
          "value": "27c785c0-cfab-8137-800f-dcf3e01a3e97",
          "mode": "list",
          "cachedResultName": "Syntech Content Ideas",
          "cachedResultUrl": "https://www.notion.so/27c785c0cfab8137800fdcf3e01a3e97"
        },
        "limit": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Limit', `How many articles should be returned for the users request`, 'number') }}",
        "filterType": "manual",
        "filters": {
          "conditions": [
            {
              "key": "Update Status|select",
              "condition": "equals",
              "selectValue": "={{ $fromAI(\"status\", \"must be one of the following (verbatim): 'duplicate', 'update', 'new'. Indicates whether an idea is a duplicate, or update of existing content, or completely new.\") }}"
            }
          ]
        },
        "options": {
          "sort": {
            "sortValue": [
              {
                "key": "Created Date|created_time",
                "direction": "descending"
              }
            ]
          }
        }
      },
      "type": "n8n-nodes-base.notionTool",
      "typeVersion": 2.2,
      "position": [
        368,
        176
      ],
      "id": "9f2efc7a-f622-4913-9f52-ff89fd680209",
      "name": "Get New Ideas1",
      "credentials": {
        "notionApi": {
          "id": "v7nNI35XIwsY1JzB",
          "name": "Syntech.granite"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "=Call this tool to find \"new\" article ideas from the content ideas Notion database from the user-specified timeframe",
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": {
          "__rl": true,
          "value": "27c785c0-cfab-8137-800f-dcf3e01a3e97",
          "mode": "list",
          "cachedResultName": "Syntech Content Ideas",
          "cachedResultUrl": "https://www.notion.so/27c785c0cfab8137800fdcf3e01a3e97"
        },
        "limit": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Limit', `The number of content ideas to find. If user provides limit eg \"most recent 5 ideas\", the value should be 5, otherwise model defines the limit`, 'number') }}",
        "filterType": "manual",
        "filters": {
          "conditions": [
            {
              "key": "Created Date|created_time",
              "condition": "after",
              "createdTimeValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('conditions0_Created_Time', `The user-specified timeframe to find ideas from i.e. User message: \"3 weeks ago from today\" -> Your input should be a date e.g. '2025-12-16'`, 'string') }}"
            },
            {
              "key": "Update Status|select",
              "condition": "equals",
              "selectValue": "={{ $fromAI(\"status\", \"must be one of the following (verbatim): 'duplicate', 'update', 'new'. Indicates whether an idea is a duplicate, or update of existing content, or completely new.\") }}"
            }
          ]
        },
        "options": {
          "sort": {
            "sortValue": [
              {
                "key": "Created Date|created_time",
                "direction": "descending"
              }
            ]
          }
        }
      },
      "type": "n8n-nodes-base.notionTool",
      "typeVersion": 2.2,
      "position": [
        560,
        176
      ],
      "id": "b2b4d101-710f-4d65-babc-457002ae304b",
      "name": "Get New Ideas (From Time Period)1",
      "credentials": {
        "notionApi": {
          "id": "v7nNI35XIwsY1JzB",
          "name": "Syntech.granite"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "=Retrieve workflow states from Supabase for multiple content ideas by their Notion page IDs.\n\nThis tool is read-only and must not cause any side effects.\n\nPurpose:\n- Check the workflow status (IN_PROGRESS, COMPLETED, CANCELLED, etc.) of content ideas\n- Merge Supabase workflow state with Notion content idea data\n- Display accurate status information to users when listing content ideas\n- Prevent duplicates by identifying which ideas are already being worked on\n\nWhen to call:\n- After retrieving content ideas from Notion (via Get_New_Ideas tools)\n- Before displaying a list of content ideas to the user\n- When the user asks about the status of specific content ideas\n- To verify if ideas are in progress before starting new work\n\nInputs:\n- Array of Notion page IDs (extracted from content ideas)\n\nBehavior:\n- Queries Supabase content_work_items table using PostgREST IN filter\n- Returns matching records with their current workflow states\n- If no matches found, returns empty array (indicates idea not yet started)\n\nOutput (for each matched item):\n- notion_page_id: The unique Notion page identifier\n- notion_url: Direct link to the Notion page\n- title: Content idea title\n- status: Current workflow state (IN_PROGRESS, COMPLETED, CANCELLED)\n- topic_signature: Stable topic identifier\n- created_at: When workflow item was created\n- updated_at: Last status update timestamp\n- cancelled_at: Cancellation timestamp (if applicable)\n- completed_at: Completion timestamp (if applicable)\n- cancel_reason: Reason for cancellation (if applicable)\n- completion_notes: Final notes (if applicable)\n\nDo not call this tool:\n- To modify workflow state (use sync_content_workflow_state instead)\n- To start, cancel, or complete work items\n- Without first having Notion page IDs to look up\n- For general searches (use Get_New_Ideas tools for that)\n\nThis tool is for state inspection only and should always be used in conjunction with content idea retrieval tools.",
        "operation": "getAll",
        "tableId": "content_work_items",
        "filterType": "string",
        "filterString": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Filters__String_', `The PostgREST query filter string for looking up multiple Notion page IDs.\n\nFormat: notion_page_id=in.(id1,id2,id3,...)\n\nExample: \"notion_page_id=in.(2c9785c0-cfab-8167-95c8-f1f5818009ce,2be785c0-cfab-812e-a4fb-d459153985b1,2bd785c0-cfab-8100-807b-f0bd306f406b)\"\n\nTo construct this filter:\n1. Extract the notion_page_id field from each content idea\n2. Join all IDs with commas (no spaces)\n3. Wrap the comma-separated list in parentheses\n4. Prefix with \"notion_page_id=in.\"\n\nDo not include quotes around individual IDs within the parentheses.`, 'string') }}"
      },
      "type": "n8n-nodes-base.supabaseTool",
      "typeVersion": 1,
      "position": [
        192,
        176
      ],
      "id": "058b7fbe-ae67-4ab5-bb1a-960a2e423b2d",
      "name": "get_workflow_states_by_notion_ids",
      "credentials": {
        "supabaseApi": {
          "id": "WzRqvoBujG4ARKMR",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "=Retrieve workflow items from Supabase filtered by their current status.\n\nThis tool is read-only and must not cause any side effects.\n\nPurpose:\n- Get all content work items in a specific workflow state\n- Answer user queries about what's in progress, completed, or cancelled\n- Provide workflow overview and status reporting\n- Help users understand their content pipeline at a glance\n\nWhen to call:\n- User asks \"what am I working on?\" or \"what's in progress?\"\n- User asks \"what have I completed?\" or \"show me finished work\"\n- User asks \"what did I cancel?\" or \"show me cancelled ideas\"\n- For workflow management and reporting queries\n- When displaying workflow state summaries\n\nInputs:\n- status: The workflow state to filter by (IN_PROGRESS, COMPLETED, or CANCELLED)\n\nBehavior:\n- Queries Supabase content_work_items table with status filter\n- Returns all items matching the specified status\n- Ordered by updated_at (most recent first)\n- If no matches found, returns empty array\n\nOutput (for each item):\n- notion_page_id\n- notion_url\n- title\n- status\n- topic_signature\n- created_at\n- updated_at\n- cancelled_at (if applicable)\n- completed_at (if applicable)\n- cancel_reason (if applicable)\n- completion_notes (if applicable)\n\nDo not call this tool:\n- To modify workflow state\n- When you already have specific Notion page IDs (use get_workflow_states_by_notion_ids instead)\n- For content idea discovery (use Get_New_Ideas tools)\n\nThis tool is for workflow status reporting and inspection only.",
        "operation": "getAll",
        "tableId": "content_work_items",
        "filterType": "string",
        "filterString": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Filters__String_', `The PostgREST query filter string for the workflow status.\n\nFormat: status=eq.{STATUS_VALUE}\n\nValid status values:\n- IN_PROGRESS\n- COMPLETED\n- CANCELLED\n\nExamples:\n- \"status=eq.IN_PROGRESS\"\n- \"status=eq.COMPLETED\"\n- \"status=eq.CANCELLED\"\n\nThe AI should construct this by replacing {STATUS_VALUE} with one of the valid status values above.`, 'string') }}"
      },
      "type": "n8n-nodes-base.supabaseTool",
      "typeVersion": 1,
      "position": [
        16,
        176
      ],
      "id": "890ecdd8-4dec-478c-9c20-f66d03506af0",
      "name": "get_workflow_items_by_status",
      "credentials": {
        "supabaseApi": {
          "id": "WzRqvoBujG4ARKMR",
          "name": "Supabase account"
        }
      }
    }
  ],
  "pinData": null,
  "repo_name": "syntech-backup-railway",
  "repo_owner": "Granite-Marketing",
  "repo_path": "https://github.com/Granite-Marketing/syntech-n8n-backup/",
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false,
    "callerPolicy": "workflowsFromSameOwner"
  },
  "shared": [
    {
      "updatedAt": "2026-01-28T08:26:51.134Z",
      "createdAt": "2026-01-28T08:26:51.134Z",
      "role": "workflow:owner",
      "workflowId": "HymQjTiMWoM1RyJU",
      "projectId": "U9sMeJya1DaokkjK"
    }
  ],
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2026-01-28T08:26:51.134Z",
  "versionId": "9a3ffbda-a275-499e-9777-fb16ec981ea2"
}